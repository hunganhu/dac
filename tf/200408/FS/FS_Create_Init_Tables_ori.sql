USE TF_KHJ
GO

DROP TABLE FS_200408
GO
/*----TF_KHJ----*/
CREATE TABLE FS_200408
(IDN Char(6),
FS002_3M_1k int, FS002_6M_1k int, FS002_9M_1k int, FS002_12M_1k int,
FS003_3M_1k int, FS003_6M_1k int, FS003_9M_1k int, FS003_12M_1k int,
FS004_3M_1k int, FS004_6M_1k int, FS004_9M_1k int, FS004_12M_1k int,
FS005_3M_1k int, FS005_6M_1k int, FS005_9M_1k int, FS005_12M_1k int,
FS006_3M_1k int, FS006_6M_1k int, FS006_9M_1k int, FS006_12M_1k int,
FS007_3M_1k int, FS007_6M_1k int, FS007_9M_1k int, FS007_12M_1k int,
FS008_3M int, FS008_6M int, FS008_9M int, FS008_12M int, FS008_12MPlus int,
FS009_3M int, FS009_6M int, FS009_9M int, FS009_12M int, FS009_12MPlus int,
/*FS010_3M int, FS010_6M int, FS010_9M int, FS010_12M int, FS010_12MPlus int,
FS011_3M int, FS011_6M int, FS011_9M int, FS011_12M int, FS011_12MPlus int,*/
FS012_3M int, FS012_6M int, FS012_9M int, FS012_12M int, FS012_12MPlus int,
/*FS013 int,*/
FS014_3M int, FS014_6M int, FS014_9M int, FS014_12M int,
FS015_3M int, FS015_6M int, FS015_9M int, FS015_12M int,
FS016_3M int, FS016_6M int, FS016_9M int, FS016_12M int,
FS017_3M int, FS017_6M int, FS017_9M int, FS017_12M int,
FS018_3M int, FS018_6M int, FS018_9M int, FS018_12M int,
/*FS019 can not be implemented with current JCIC data*/
FS020_3M int, FS020_6M int, FS020_9M int, FS020_12M int,
FS021_3M int, FS021_6M int, FS021_9M int, FS021_12M int,
/*FS022 can not be implemented with current JCIC data*/
FS023_3M int, FS023_6M int, FS023_9M int, FS023_12M int,
FS024_3M int, FS024_6M int, FS024_9M int, FS024_12M int,
FS025_3M int, FS025_6M int, FS025_9M int, FS025_12M int,
/*FS026 can not be implemented with current JCIC data*/
FS027 int,
FS028 int,
FS029 int,
FS030 int,
FS031 int,
FS032_3M int, FS032_6M int, FS032_9M int, FS032_12M int,
FS033 int,
FS034 int,
FS035 int,
FS036 int,
FS037 int,
FS038 int,
FS039 int,
FS040 int,
FS041 int,
FS042 int,
FS043 int,
FS044 int,
FS045 int,
FS046 int,
FS047 int,
FS048 int,
FS049 int,
FS050 int,
FS051 int,
FS052 int,
FS053 int,
FS054 int,
FS055 int,
FS056_3M_1k int, FS056_6M_1k int, FS056_9M_1k int, FS056_12M_1k int,
FS057_3M_1k int, FS057_6M_1k int, FS057_9M_1k int, FS057_12M_1k int,
FS058_3M_1k int, FS058_6M_1k int, FS058_9M_1k int, FS058_12M_1k int,
FS059_3M_1k int, FS059_6M_1k int, FS059_9M_1k int, FS059_12M_1k int,
FS060_3M_1k int, FS060_6M_1k int, FS060_9M_1k int, FS060_12M_1k int,
FS061_3M_1k int, FS061_6M_1k int, FS061_9M_1k int, FS061_12M_1k int,
FS062_3M_1k int, FS062_6M_1k int, FS062_9M_1k int, FS062_12M_1k int,
FS063_3M_1k int, FS063_6M_1k int, FS063_9M_1k int, FS063_12M_1k int,
FS064_3M_1k int, FS064_6M_1k int, FS064_9M_1k int, FS064_12M_1k int,
FS065_3M_1k int, FS065_6M_1k int, FS065_9M_1k int, FS065_12M_1k int,
FS066_3M_1k int, FS066_6M_1k int, FS066_9M_1k int, FS066_12M_1k int,
FS067_3M_1k int, FS067_6M_1k int, FS067_9M_1k int, FS067_12M_1k int,
FS068 int, FS069 int, FS070 int, FS071 int
)
GO

INSERT INTO FS_200408(IDN)
SELECT
IDN
FROM Base_200408
GO
/*220*/
UPDATE FS_200408
SET
FS002_3M_1k=0, FS002_6M_1k=0, FS002_9M_1k=0, FS002_12M_1k=0,
FS003_3M_1k=0, FS003_6M_1k=0, FS003_9M_1k=0, FS003_12M_1k=0,
FS004_3M_1k=0, FS004_6M_1k=0, FS004_9M_1k=0, FS004_12M_1k=0,
FS005_3M_1k=0, FS005_6M_1k=0, FS005_9M_1k=0, FS005_12M_1k=0,
FS006_3M_1k=0, FS006_6M_1k=0, FS006_9M_1k=0, FS006_12M_1k=0,
FS007_3M_1k=0, FS007_6M_1k=0, FS007_9M_1k=0, FS007_12M_1k=0,
FS056_3M_1k=0, FS056_6M_1k=0, FS056_9M_1k=0, FS056_12M_1k=0,
FS057_3M_1k=0, FS057_6M_1k=0, FS057_9M_1k=0, FS057_12M_1k=0,
FS058_3M_1k=0, FS058_6M_1k=0, FS058_9M_1k=0, FS058_12M_1k=0,
FS059_3M_1k=0, FS059_6M_1k=0, FS059_9M_1k=0, FS059_12M_1k=0,
FS060_3M_1k=0, FS060_6M_1k=0, FS060_9M_1k=0, FS060_12M_1k=0,
FS061_3M_1k=0, FS061_6M_1k=0, FS061_9M_1k=0, FS061_12M_1k=0,
FS062_3M_1k=0, FS062_6M_1k=0, FS062_9M_1k=0, FS062_12M_1k=0,
FS063_3M_1k=0, FS063_6M_1k=0, FS063_9M_1k=0, FS063_12M_1k=0,
FS064_3M_1k=0, FS064_6M_1k=0, FS064_9M_1k=0, FS064_12M_1k=0,
FS065_3M_1k=0, FS065_6M_1k=0, FS065_9M_1k=0, FS065_12M_1k=0,
FS066_3M_1k=0, FS066_6M_1k=0, FS066_9M_1k=0, FS066_12M_1k=0,
FS067_3M_1k=0, FS067_6M_1k=0, FS067_9M_1k=0, FS067_12M_1k=0,
FS014_3M=0, FS014_6M=0, FS014_9M=0, FS014_12M=0,
FS015_3M=0, FS015_6M=0, FS015_9M=0, FS015_12M=0,
FS016_3M=0, FS016_6M=0, FS016_9M=0, FS016_12M=0,
FS017_3M=0, FS017_6M=0, FS017_9M=0, FS017_12M=0,
FS018_3M=0, FS018_6M=0, FS018_9M=0, FS018_12M=0,
FS021_3M=0, FS021_6M=0, FS021_9M=0, FS021_12M=0
FROM Base_200408 AS A
WHERE A.IDN = FS_200408.IDN AND
      AVAIL_FLAG & 0x01 = 0x01
GO
/*171, KRM023*/
UPDATE FS_200408
SET
FS008_3M=0, FS008_6M=0, FS008_9M=0, FS008_12M=0, FS008_12MPlus=0,
FS009_3M=0, FS009_6M=0, FS009_9M=0, FS009_12M=0, FS009_12MPlus=0,
FS012_3M=0, FS012_6M=0, FS012_9M=0, FS012_12M=0, FS012_12MPlus=0,
FS023_3M=0, FS023_6M=0, FS023_9M=0, FS023_12M=0,
FS024_3M=0, FS024_6M=0, FS024_9M=0, FS024_12M=0,
FS025_3M=0, FS025_6M=0, FS025_9M=0, FS025_12M=0,
FS032_3M=0, FS032_6M=0, FS032_9M=0, FS032_12M=0,
FS020_3M=0, FS020_6M=0, FS020_9M=0, FS020_12M=0
FROM Base_200408 AS A
WHERE A.IDN = FS_200408.IDN AND
      AVAIL_FLAG & 0x02 = 0x02
GO
/*181, KRM001*/

/*UPDATE FS_200408
SET
FS013=0
FROM AAS001_200408_idn AS A
WHERE A.IDN = FS_200408.IDN
GO*/

UPDATE FS_200408
SET
FS027=0,
FS028=0,
FS029=0,
FS030=0,
FS031=0
FROM Base_200408 AS A
WHERE A.IDN = FS_200408.IDN AND
      AVAIL_FLAG & 0x10 = 0x10
GO
/*220, STM001*/
/*UPDATE FS_200408
SET
FS010_3M=0, FS010_6M=0, FS010_9M=0, FS010_12M=0, FS010_12MPlus=0,
FS011_3M=0, FS011_6M=0, FS011_9M=0, FS011_12M=0, FS011_12MPlus=0
FROM NCCC_200408_Base_New AS A
WHERE A.IDN = FS_200408.IDN
GO*/

UPDATE FS_200408
SET
FS033=0,
FS034=0,
FS035=0,
FS036=0,
FS037=0,
FS038=0,
FS039=0,
FS040=0,
FS041=0,
FS042=0,
FS043=0,
FS044=0,
FS045=0,
FS046=0,
FS047=0,
FS048=0,
FS049=0,
FS050=0,
FS051=0,
FS052=0,
FS053=0,
FS054=0,
FS055=0,
FS068=0,
FS069=0,
FS070=0,
FS071=0
FROM Base_200408 AS A
WHERE A.IDN = FS_200408.IDN AND
      AVAIL_FLAG & 0x04 = 0x04
GO
/*185, BAM085*/

DROP TABLE FS_TMP
GO
DROP TABLE LINES
GO
DROP TABLE OPEN_ISSUER
GO
DROP TABLE FS_TMP1
GO
DROP TABLE FS_TMP2
GO

CREATE TABLE FS_TMP
(IDN Char(6),
 Mon INT,
 V1 int,
 V2 int,
 V3 int)
GO

CREATE TABLE FS_TMP1
(IDN Char(6),
 Mon INT,
 V1 int)
GO

/*----Create temp table for calculating incremental line----*/
CREATE TABLE Lines
(IDN Char(6),
 Issuer char(3),
 Mon int,
 Line int)
GO

CREATE TABLE Open_Issuer
(IDN Char(6),
 Issuer char(3),
 MON int)
GO

CREATE TABLE FS_TMP2
(IDN Char(6),
 Issuer char(3),
 Mon int,
 Line int)
GO


