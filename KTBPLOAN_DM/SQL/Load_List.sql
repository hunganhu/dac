USE PLOAN_MKT
GO

SELECT TOP 10 * FROM ML
GO

--Col001 - MSN, Col002 - IDN, Col003 - CNAME, Col004 - ADDRESS, Col005 - PRODUCT_ID, Col006 - DM_CELL, Col007 - DM_BATCH, Col008 - MAIL_DATE, Col010 APPLICATION_FEE, Col009 RATE

INSERT INTO dbo.MAIL_LIST(MSN, IDN, CNAME, ADDRESS, PRODUCT_CODE, DM_CELL, DM_BATCH, MAIL_DATE)
SELECT Col001, Col002, Col003, Col004, Col005, Col006, Col007, CONVERT(CHAR(4), CONVERT(INT, LEFT(Col008, 2)) + 1911) + '0' + SUBSTRING(Col008, 4, 1) + SUBSTRING(Col008, 6, 2)
FROM ML

INSERT INTO PRODUCT_LOOKUP(CODE)
SELECT DISTINCT Col005
FROM ML

UPDATE PRODUCT_LOOKUP
SET
RATE = CONVERT(DECIMAL(6,5),CONVERT(FLOAT, REPLACE(Col009, '%', '')) / 100.0)
FROM ML AS A
WHERE PRODUCT_LOOKUP.CODE = A.Col005

UPDATE PRODUCT_LOOKUP
SET
APPLICATION_FEE = CONVERT(INT, Col010)
FROM ML AS A
WHERE PRODUCT_LOOKUP.CODE = A.Col005


SELECT * FROM PRODUCT_LOOKUP

SELECT DISTINCT Col009 FROM ML WHERE Col005 = '224'
