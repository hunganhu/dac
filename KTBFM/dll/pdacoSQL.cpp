/****************************************************************************
** Licensed Materials - Property of DAC
**
** (C) COPYRIGHT Decision Analytics Consulting 2005, 2006
** All Rights Reserved.
**
*****************************************************************************
**
** SOURCE FILE NAME: pdacoSQL.cpp
**
** Description: PDACO V1.00 SQL code
**
****************************************************************************/
//---------------------------------------------------------------------------
#pragma hdrstop

#include "pdacoSQL.h"

//---------------------------------------------------------------------------
#pragma package(smart_init)
//---------------------------------------------------------------------------

char *SQLCommands[] = {
/* Get_AppInfo_Test */
" SELECT case_no, NAV, [Loan amount], [Original APR_1], [Original APR_2], [Original APR_3], "
" Term_1, Term_2, Term_3, Grace_period, Property_flag, PB "
" from NPVTEST"
" where CASE_NO = :v0;",

/* Get_AppInfo_BT */
" SELECT case_no, idn, NAV, loan_amt, inquiry_date "
" from input"
" where CASE_NO = :v0;",

/* Get_AppInfo_Record */
" SELECT CASE_NO, APP_DATE, PROD_TYPE, APP_ID, APP_NAME, APP_BIRTHDAY, APP_MARRIAGE, APP_EDUCATION,"
" APP_INCOME, APP_QUALIFIED, COS_ID, COS_NAME, COS_BIRTHDAY, COS_MARRIAGE, COS_EDUCATION, COS_INCOME,"
" COS_QUALIFIED, GUA_ID, GUA_NAME, GUA_BIRTHDAY, GUA_MARRIAGE, GUA_EDUCATION, GUA_INCOME,"
" GUA_QUALIFIED, APP_AMT, PERIOD, APR1, SEG1, APR2, SEG2, APR3, SEG3, GRACE_PERIOD, APP_FEE,"
" OWNER_ID, OWNER_NAME, LAND_NUM, RELATIONSHIP, GAV, NAV, COL_QUALIFIED, PREMIUM_COL,"
" MONTHLY_PAYMENT, INQUIRY_DATE, BRANCH, EMP_ID, AUDITOR "
" from APP_INFO"
" where CASE_NO = :v0;",

/*Get_Prescreen_Result*/
" select JAS002_DEFECT, KRM021_HIT, KRM023_HIT, BAM086_HIT, MAX_BUCKET, FS044, FS059_1K_12M,"
" FS302, FS334, CARD_FORCE_STOP, CASH_MAX_BUCKET, CASH_UTILIZATION, IND001, REVOLVING_AMT"
" from #PDACO_V1_00_CAL"
" where CASE_NO = :v0",

/*Get_PDACO_Score*/
" select PDACO_SCORE, PDACO_TWEN, PB_IN, MS101"
" from #PDACO_V1_00_CAL"
" where CASE_NO = :v0",

/*Get_Overall_Lookup*/
" SELECT DISPOSITION_CODE, DISPOSITION_MESSAGE,"
"        APPLICANT_MESSAGE, CO_APPLICANT_MESSAGE, GUARANTOR_MESSAGE,"
"        PDACO_CODE, INCOME_CODE, MS101_CODE"
" FROM OVERALL_LOOKUP"
" WHERE APPLICANT_STATUS = :v0"
"   AND CO_APPLICANT_STATUS = :v1"
"   AND GUARANTOR_STATUS = :v2;"
,
/*Get_Fianl_Lookup*/
" SELECT MESSAGE_DISPOSITION,"
"        APPLICANT_MESSAGE, CO_APPLICANT_MESSAGE, GUARANTOR_MESSAGE"
" FROM BRANCH_11_LOOKUP"
" WHERE APPLICANT_STATUS = :v0"
"   AND CO_APPLICANT_STATUS = :v1"
"   AND GUARANTOR_STATUS = :v2"
"   AND DISPOSITION_CODE = :v3;"
,
/* Create_Working_Tables */
" IF OBJECT_ID('tempdb..#BAM086_DEDUP') IS NOT NULL"
"    DROP TABLE #BAM086_DEDUP;"
" CREATE TABLE #BAM086_DEDUP ("
" 	CASE_NO		 VARCHAR(20),"
" 	INQUIRY_DATE	 CHAR(10),"
" 	IDN 		 CHAR(11),"
"	DATA_YYY         CHAR(3),"
"	DATA_MM          CHAR(2),"
"	BANK_CODE        CHAR(7),"
"	BANK_NAME        CHAR(40),"
"	ACCOUNT_CODE     CHAR(1),"
"	ACCOUNT_CODE2    CHAR(1),"
"	PURPOSE_CODE     CHAR(1),"
"	CONTRACT_AMT     DECIMAL (10),"
"	LOAN_AMT         DECIMAL (10),"
"	PASS_DUE_AMT     DECIMAL (10),"
"	PAY_CODE_12      CHAR(12),"
"	CO_LOAN          CHAR(1),"
"	UN_MARK          CHAR(1),"
"	U_YYYMMDD        CHAR(8),"
"	U_RATE           CHAR(3),"
"	IB_MARK          CHAR(1),"
"	IAB_BAN          CHAR(8),"
"	IAB_NAME         CHAR(60),"
"	R_YYYMMDD        CHAR(7),"
"	REFUND_AMT       CHAR(10),"
"	CK_REF           CHAR(1),"
" 	BANK_CODE2	 CHAR (3),"
" 	MON_SINCE	 INT,"
" 	CYCLE		 INT,"
" 	CNT		 INT);"
" IF OBJECT_ID('tempdb..#BAM086_BUCKET') IS NOT NULL"
"    DROP TABLE #BAM086_BUCKET;"
" CREATE TABLE #BAM086_BUCKET ("
" 	IDN CHAR(14),"
" 	BANK_CODE CHAR(3),"
" 	MON_SINCE INT,"
" 	BUCKET FLOAT);"
" IF OBJECT_ID('tempdb..#KRM021_DEDUP') IS NOT NULL"
"    DROP TABLE #KRM021_DEDUP;"
" CREATE TABLE #KRM021_DEDUP ("
" 	CASE_NO		 VARCHAR(20),"
" 	INQUIRY_DATE	 CHAR(10),"
" 	IDN		 CHAR (11),"
" 	CARD_BRAND	 CHAR (1),"
" 	CARD_TYPE	 CHAR (1),"
" 	ISSUE		 CHAR (3),"
" 	ISSUE_NAME	 CHAR (40),"
" 	START_DATE	 CHAR (7),"
" 	STOP_DATE	 CHAR (7),"
" 	STOP_CODE	 CHAR (1),"
" 	AB_CODE		 CHAR (1),"
" 	M_S		 CHAR (1),"
"        RELA		 CHAR(1),"
"        LIMIT		 CHAR(6),"
"        RISK		 CHAR(6),"
"        CLEAR_DATE	 CHAR(7),"
"        IDN_PRI		 CHAR(10),"
"        CNAME		 CHAR(12),"
"        REMARK		 CHAR(40),"
" 	START_MON_SINCE	 INT,"
" 	END_MON_SINCE	 INT,"
" 	CNT		 INT);"
" IF OBJECT_ID('tempdb..#KRM023_DEDUP') IS NOT NULL"
"    DROP TABLE #KRM023_DEDUP;"
" CREATE TABLE #KRM023_DEDUP ("
" 	CASE_NO		 VARCHAR(20),"
" 	INQUIRY_DATE	 CHAR(10),"
" 	IDN		 CHAR (11),"
"	YRMON 		 CHAR (5),"
"	ISSUE 		 CHAR (3),"
"	ISSUE_NAME 	 CHAR (40),"
"	KR_CODE 	 CHAR (7),"
"	LIMIT 		 CHAR (5),"
"	PAYMENT 	 CHAR (3),"
"	CASH 		 CHAR (1),"
"	PAY_CODE 	 CHAR (1),"
" 	MON_SINCE	 INT,"
" 	PAYMENT_AMT	 FLOAT,"
" 	BUCKET_DEF_1K	 INT DEFAULT 0,"
" 	BUCKET_EF_1K	 INT DEFAULT 0,"
" 	BUCKET_F_1K	 INT DEFAULT 0,"
" 	PRE_OWED	 FLOAT,"
" 	CNT		 INT);"
" IF OBJECT_ID('tempdb..#KRM037_DEDUP') IS NOT NULL"
"    DROP TABLE #KRM037_DEDUP;"
" CREATE TABLE #KRM037_DEDUP ("
"	CASE_NO		VARCHAR(20),"
"	INQUIRY_DATE	CHAR(10),"
"	IDN		CHAR(10),"
"	IDN_BAN		CHAR(10),"
"	BILL_DATE	CHAR(7),"
"	ISSUE		CHAR(3),"
"	ISSUE_NAME 	CHAR(24),"
"	CARD_TYPE 	CHAR(7),"
"	PERM_LIMIT 	CHAR(7),"
"	TEMP_LIMIT 	CHAR(7),"
"	CASH_LIMIT 	CHAR(7),"
"	PAYABLE 	CHAR(3),"
"	CASH_LENT 	CHAR(8),"
"	LAST_PAYA 	CHAR(3),"
"	REVOL_BAL 	CHAR(9),"
"	PAY_STAT 	CHAR(1),"
"	PAY_CODE 	CHAR(1),"
"	REVOL_RATE 	CHAR(4),"
"	PRE_OWED 	CHAR(8),"
"	DEBT_CODE 	CHAR(1),"
"	CLOSE_CODE 	CHAR(1),"
"	CLEAR_DATE 	CHAR(7),"
"	MON_SINCE	INT,"
" 	PAYMENT_AMT	FLOAT,"
" 	BUCKET_DEF_1K	INT DEFAULT 0,"
" 	BUCKET_EF_1K	INT DEFAULT 0,"
" 	BUCKET_F_1K	INT DEFAULT 0,"
"	NOW		INT,"
"	CURR_INQMON	INT,"
" 	CNT		INT);"
" IF OBJECT_ID('tempdb..#STM007_DEDUP') IS NOT NULL"
"    DROP TABLE #STM007_DEDUP;"
" CREATE TABLE #STM007_DEDUP ("
" 	CASE_NO VARCHAR(20),"
" 	INQUIRY_DATE	    CHAR(10),"
" 	IDN CHAR (11),"
" 	BANK_CODE CHAR (7),"
" 	BANK_NAME CHAR (40),"
" 	QUERY_DATE CHAR (7),"
" 	ITEM_LIST CHAR (10),"
"	INQ_PURPOSE_1	CHAR(1),"
"	INQ_PURPOSE	CHAR(30),"
" 	QUERY_MON_SINCE INT,"
" 	CNT INT);"
" IF OBJECT_ID('tempdb..#JAS002_T') IS NOT NULL"
"    DROP TABLE #JAS002_T;"
" CREATE TABLE #JAS002_T ("
" 	CASE_NO VARCHAR(20),"
" 	IDN CHAR (11),"
" 	REASON CHAR (1),"
" 	DATE_HAPPEN CHAR (7),"
" 	MON_SINCE INT);"
" IF OBJECT_ID('tempdb..#JAS002_T_DEDUP') IS NOT NULL"
"    DROP TABLE #JAS002_T_DEDUP;"
" CREATE TABLE #JAS002_T_DEDUP ("
" 	CASE_NO VARCHAR(20),"
" 	IDN CHAR (11),"
" 	REASON CHAR (1),"
" 	DATE_HAPPEN CHAR (7),"
" 	MON_SINCE INT,"
" 	CNT INT);"
" IF OBJECT_ID('tempdb..#BASE') IS NOT NULL"
"    DROP TABLE #BASE;"
" CREATE TABLE #BASE ("
"  	IDN CHAR (11),"
" 	AVAIL_FLAG INT DEFAULT 0,"
" 	JAS002_DEFECT INT DEFAULT 0,"
" 	KRM021_HIT INT DEFAULT 0,"
" 	KRM023_HIT INT DEFAULT 0,"
" 	MAX_BUCKET INT DEFAULT 0,"
" 	FS044 INT DEFAULT 0,"
" 	CASH_MAX_BUCKET INT DEFAULT 0,"
" 	CASH_UTILIZATION INT DEFAULT 0,"
"        IND001 INT DEFAULT 0);"
" IF OBJECT_ID('tempdb..#TMP') IS NOT NULL"
"    DROP TABLE #TMP;"
" CREATE TABLE #TMP ("
"	IDN CHAR(11),"
"	MON INT,"
"	V1 DECIMAL (16, 8),"
"	V2 DECIMAL (16, 8),"
"	V3 DECIMAL (16, 8));"
" IF OBJECT_ID('tempdb..#TMP1') IS NOT NULL"
"    DROP TABLE #TMP1;"
" CREATE TABLE #TMP1 ("
"	IDN CHAR(11),"
"	MON INT,"
"	V1 DECIMAL (16, 8));"
" IF OBJECT_ID('tempdb..#OPEN_ISSUE') IS NOT NULL"
"    DROP TABLE #OPEN_ISSUE;"
" CREATE TABLE #OPEN_ISSUE ("
"	IDN CHAR(11),"
"	ISSUE CHAR(3),"
"	MON INT);"
" IF OBJECT_ID('tempdb..#OPEN_CARD') IS NOT NULL"
"    DROP TABLE #OPEN_CARD;"
" CREATE TABLE #OPEN_CARD ("
"	IDN CHAR(11),"
"	ISSUE CHAR(3),"
"	MON INT);"
" IF OBJECT_ID('tempdb..#OPEN_LINE') IS NOT NULL"
"    DROP TABLE #OPEN_LINE;"
" CREATE TABLE #OPEN_LINE ("
"	IDN CHAR(11),"
"	ISSUE CHAR(3),"
"	MON INT,"
"	CARDS INT,"
"	BUCKET INT);"
" IF OBJECT_ID('tempdb..#LATEST_STMT_MON') IS NOT NULL"
"    DROP TABLE #LATEST_STMT_MON;"
" CREATE TABLE #LATEST_STMT_MON ("
"	IDN CHAR(11),"
"	ISSUE CHAR(3),"
"	MON INT);"
" IF OBJECT_ID('tempdb..#LATEST_LINE') IS NOT NULL"
"    DROP TABLE #LATEST_LINE;"
" CREATE TABLE #LATEST_LINE ("
"	IDN CHAR(11),"
"	ISSUE CHAR(3),"
"	MON INT,"
"	MOB INT);"
" IF OBJECT_ID('tempdb..#KRM023_TMP') IS NOT NULL"
"    DROP TABLE #KRM023_TMP;"
" CREATE TABLE #KRM023_TMP ("
"	CASE_NO CHAR(14),"
"	IDN CHAR(11),"
"	MON_SINCE INT,"
"	ISSUE CHAR(3),"
"	ISSUE_NAME CHAR(40),"
"	LIMIT CHAR(5),"
"	PAYMENT CHAR(3),"
"	PAYMENT_AMT FLOAT,"
"	CASH CHAR,"
"	PAY_CODE CHAR,"
"	SPREAD_PAYMENT FLOAT);"
" IF OBJECT_ID('tempdb..#KRM023_TMP1') IS NOT NULL"
"    DROP TABLE #KRM023_TMP1;"
" CREATE TABLE #KRM023_TMP1 ("
"	CASE_NO CHAR(14),"
"	IDN CHAR(11),"
"	MON_SINCE INT,"
"	ISSUE CHAR(3),"
"	ISSUE_NAME CHAR(40),"
"	LIMIT CHAR(5),"
"	PAYMENT_AMT FLOAT,"
"	CASH CHAR,"
"	PAY_CODE CHAR,"
"	SPREAD_PAYMENT FLOAT);"
" IF OBJECT_ID('tempdb..#PDACO_V1_00_CAL') IS NOT NULL"
"    DROP TABLE #PDACO_V1_00_CAL;"
" CREATE TABLE #PDACO_V1_00_CAL ("
"	CASE_NO VARCHAR(20),"
"	IDN CHAR (11),"
"	INQUIRY_DATE CHAR(8),"
"	NOW INT,"
"	AVAIL_FLAG INT,"
"	JAS002_DEFECT INT DEFAULT 0,"
"	KRM021_HIT INT DEFAULT 0,"
"	KRM023_HIT INT DEFAULT 0,"
"	BAM086_HIT INT DEFAULT 0,"
"	MAX_BUCKET INT DEFAULT 0,"
"	FS044 INT DEFAULT 0,"
"	FS059_1K_12M	INT DEFAULT 0,"
"	FS302 INT DEFAULT 0,"
"	FS334 INT DEFAULT 0,"
"	CARD_FORCE_STOP INT DEFAULT 0,"
"	CASH_MAX_BUCKET INT DEFAULT 0,"
"	CASH_UTILIZATION INT DEFAULT 0,"
"	IND001 INT DEFAULT 0,"
"	CARD_REV_BAL FLOAT DEFAULT 0,"
"	CASH_REV_BAL FLOAT DEFAULT 0,"
"	REVOLVING_AMT FLOAT DEFAULT 0,"
"	FS102_3M	DECIMAL(16,8),"
"	FS102_6M	DECIMAL(16,8),"
"	FS102_9M	DECIMAL(16,8),"
"	FT102_42	DECIMAL(16,8),"
"	FT102_42_R	DECIMAL(16,8),"
"	FT102_42_R_TRAN	DECIMAL(16,8),"
"	FS031		DECIMAL(16,8),"
"	FS031_TRAN	DECIMAL(16,8),"
"	FS005_1K_3M	DECIMAL(16,8),"
"	FS005_1K_3M_Q	DECIMAL(16,8),"
"	FS005_1K_3M_Q_TRAN	DECIMAL(16,8),"
"	FS059_1K_3M	DECIMAL(16,8),"
"	FS059_1K_6M	DECIMAL(16,8),"
"	FS059_1K_9M	DECIMAL(16,8),"
"	FT059_1K_43	DECIMAL(16,8),"
"	FT059_1K_43_R	DECIMAL(16,8),"
"	FT059_1K_43_R_TRAN	DECIMAL(16,8),"
"	FT059_1K_42	DECIMAL(16,8),"
"	FT059_1K_42_Q	DECIMAL(16,8),"
"	FT059_1K_42_Q_TRAN	DECIMAL(16,8),"
"	FS051		DECIMAL(16,8),"
"	FS051_TRAN	DECIMAL(16,8),"
"	FS016_3M	DECIMAL(16,8),"
"	FS101_3M	DECIMAL(16,8),"
"	INT015_3	DECIMAL(16,8),"
"	INT015_3_TRAN	DECIMAL(16,8),"
"	FS205_1K_3M	DECIMAL(16,8),"
"	FS205_1K_3M_Q	DECIMAL(16,8),"
"	FS205_1K_3M_Q_TRAN	DECIMAL(16,8),"
"	FS212_1K_3M	DECIMAL(16,8),"
"	FS212_1K_6M	DECIMAL(16,8),"
"	FT212_1K_43	DECIMAL(16,8),"
"	FT212_1K_43_Q	DECIMAL(16,8),"
"	FT212_1K_43_Q_TRAN	DECIMAL(16,8),"
"	MS117_6M	DECIMAL(16,8),"
"	FS014_9M	DECIMAL(16,8),"
"	FS101_9M	DECIMAL(16,8),"
"	INT028_9	DECIMAL(16,8),"
"	INT028_9_TRAN	DECIMAL(16,8),"
"	SEX		INT,"
"	SEX_TRAN	INT,"
"	APP_LAST_MONTH_BUCKET INT,"
"	APP_LAST_MONTH_BUCKET_TRAN INT,"
"	PDACO_SCORE	DECIMAL(16,8),"
"	PDACO_TWEN	DECIMAL(16,8),"
"	PB_IN		DECIMAL(16,8),"
"	PB_INOUT	DECIMAL(16,8),"
"	MS093		DECIMAL(16,8),"
"	MS094		DECIMAL(16,8),"
"	MS105		DECIMAL(16,8),"
"	MS101		DECIMAL(16,8));"
,
/* DROP_WORKING_TABLES */
" DROP TABLE #BAM086_DEDUP;"
" DROP TABLE #BAM086_BUCKET;"
" DROP TABLE #KRM021_DEDUP;"
" DROP TABLE #KRM023_DEDUP;"
" DROP TABLE #KRM037_DEDUP;"
" DROP TABLE #STM007_DEDUP;"
" DROP TABLE #JAS002_T;"
" DROP TABLE #JAS002_T_DEDUP;"
" DROP TABLE #BASE;"
" DROP TABLE #TMP;"
" DROP TABLE #TMP1;"
" DROP TABLE #OPEN_CARD;"
" DROP TABLE #OPEN_LINE;"
" DROP TABLE #LATEST_STMT_MON;"
" DROP TABLE #LATEST_LINE;"
" DROP TABLE #KRM023_TMP;"
" DROP TABLE #KRM023_TMP1;"
" DROP TABLE #PDACO_V1_00_CAL;"
,
/* DROP_PROCEDURE_PREPARE_JCIC_DATA */
" if exists (select * from dbo.sysobjects where id = object_id(N'[PREPARE_PDACO_JCIC_DATA]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)"
" drop procedure PREPARE_PDACO_JCIC_DATA;",

/* EXEC_PROCEDURE_PREPARE_JCIC_DATA */
"Execute PREPARE_PDACO_JCIC_DATA :v0, :v1, :v2;",

/* CREATE_PROCEDURE_PREPARE_JCIC_DATA*/
" CREATE PROCEDURE PREPARE_PDACO_JCIC_DATA"
"  (@CASE_NO VARCHAR(20),"
"   @IDN CHAR(11),"
"   @NOW INT)"
"  AS"
" INSERT INTO #PDACO_V1_00_CAL(CASE_NO, IDN, NOW)"
"  VALUES (@CASE_NO, @IDN, @NOW)"
" INSERT INTO #KRM021_DEDUP (CASE_NO, IDN, CARD_BRAND, CARD_TYPE, ISSUE, ISSUE_NAME, START_DATE, STOP_DATE, STOP_CODE, AB_CODE, M_S, LIMIT, CNT)"
"  SELECT CASE_NO, IDN, CARD_BRAND, CARD_TYPE, ISSUE, ISSUE_NAME, START_DATE, STOP_DATE, STOP_CODE, AB_CODE, M_S, LIMIT, COUNT(*)"
"  FROM KRM021"
"  WHERE CASE_NO = @CASE_NO AND IDN = @IDN"
"  GROUP BY CASE_NO, IDN, CARD_BRAND, CARD_TYPE, ISSUE, ISSUE_NAME, START_DATE, STOP_DATE, STOP_CODE, AB_CODE, M_S, LIMIT;"
""
" INSERT INTO #KRM023_DEDUP (CASE_NO, IDN, ISSUE, ISSUE_NAME, LIMIT, YRMON, KR_CODE, PAYMENT, CASH, PAY_CODE, CNT)"
"  SELECT CASE_NO, IDN, ISSUE, ISSUE_NAME, LIMIT, YRMON, KR_CODE, PAYMENT, CASH, PAY_CODE, COUNT(*)"
"  FROM KRM023"
"  WHERE CASE_NO = @CASE_NO AND IDN = @IDN"
"  GROUP BY CASE_NO, IDN, ISSUE, ISSUE_NAME, LIMIT, YRMON, KR_CODE, PAYMENT, CASH, PAY_CODE;"
" INSERT INTO #STM007_DEDUP (CASE_NO, IDN, BANK_CODE, BANK_NAME, QUERY_DATE, ITEM_LIST, CNT)"
"  SELECT CASE_NO, IDN, BANK_CODE, BANK_NAME, QUERY_DATE, ITEM_LIST, COUNT(*)"
"  FROM STM007"
"  WHERE CASE_NO = @CASE_NO AND IDN = @IDN"
"  GROUP BY CASE_NO, IDN, BANK_CODE, BANK_NAME, QUERY_DATE, ITEM_LIST;"
" INSERT INTO #BAM086_DEDUP (CASE_NO, IDN, DATA_YYY, DATA_MM, BANK_CODE, BANK_NAME, ACCOUNT_CODE, ACCOUNT_CODE2, PURPOSE_CODE, CONTRACT_AMT, LOAN_AMT, PASS_DUE_AMT, PAY_CODE_12, CO_LOAN, CNT)"
"  SELECT CASE_NO, IDN, DATA_YYY, DATA_MM, BANK_CODE, BANK_NAME, ACCOUNT_CODE, ACCOUNT_CODE2, PURPOSE_CODE, CAST(CONTRACT_AMT AS INT), CAST(LOAN_AMT AS INT), CAST(PASS_DUE_AMT AS INT), PAY_CODE_12, CO_LOAN, COUNT(*)"
"  FROM BAM086"
"  WHERE CASE_NO = @CASE_NO AND IDN = @IDN"
"  GROUP BY CASE_NO, IDN, DATA_YYY, DATA_MM, BANK_CODE, BANK_NAME, ACCOUNT_CODE, ACCOUNT_CODE2, PURPOSE_CODE, CONTRACT_AMT, LOAN_AMT, PASS_DUE_AMT, PAY_CODE_12, CO_LOAN;"
" INSERT INTO #KRM037_DEDUP(CASE_NO, INQUIRY_DATE, IDN, IDN_BAN, BILL_DATE, ISSUE, ISSUE_NAME, CARD_TYPE, PERM_LIMIT, TEMP_LIMIT, CASH_LIMIT, PAYABLE, CASH_LENT, LAST_PAYA, REVOL_BAL, PAY_STAT, PAY_CODE, REVOL_RATE, PRE_OWED, DEBT_CODE, CLOSE_CODE, CLEAR_DA"
"TE)"
"  SELECT CASE_NO, INQUIRY_DATE, IDN, IDN_BAN, BILL_DATE, ISSUE, ISSUE_NAME, CARD_TYPE, PERM_LIMIT, TEMP_LIMIT, CASH_LIMIT, PAYABLE, CASH_LENT, LAST_PAYA, REVOL_BAL, PAY_STAT, PAY_CODE, REVOL_RATE, PRE_OWED, DEBT_CODE, CLOSE_CODE, CLEAR_DATE"
"  FROM KRM037"
"  WHERE ISSUE != 'TOT'"
"    AND CASE_NO = @CASE_NO AND IDN = @IDN"
"  GROUP BY CASE_NO, INQUIRY_DATE, IDN, IDN_BAN, BILL_DATE, ISSUE, ISSUE_NAME, CARD_TYPE, PERM_LIMIT, TEMP_LIMIT, CASH_LIMIT, PAYABLE, CASH_LENT, LAST_PAYA, REVOL_BAL, PAY_STAT, PAY_CODE, REVOL_RATE, PRE_OWED, DEBT_CODE, CLOSE_CODE, CLEAR_DATE"
" UPDATE #KRM021_DEDUP"
"    SET CASE_NO      = (CASE WHEN CASE_NO =      '' THEN NULL ELSE CASE_NO END),"
"        INQUIRY_DATE = (CASE WHEN INQUIRY_DATE = '' THEN NULL ELSE INQUIRY_DATE END),"
"        IDN          = (CASE WHEN IDN =          '' THEN NULL ELSE IDN END),"
"        CARD_BRAND   = (CASE WHEN CARD_BRAND   = '' THEN NULL ELSE CARD_BRAND END),"
"        CARD_TYPE    = (CASE WHEN CARD_TYPE    = '' THEN NULL ELSE CARD_TYPE  END),"
"        ISSUE        = (CASE WHEN ISSUE        = '' THEN NULL ELSE ISSUE      END),"
"        ISSUE_NAME   = (CASE WHEN ISSUE_NAME   = '' THEN NULL ELSE ISSUE_NAME END),"
"        START_DATE   = (CASE WHEN START_DATE   = '' THEN NULL ELSE START_DATE END),"
"        STOP_DATE    = (CASE WHEN STOP_DATE    = '' THEN NULL ELSE STOP_DATE  END),"
"        STOP_CODE    = (CASE WHEN STOP_CODE    = '' THEN NULL ELSE STOP_CODE  END),"
"        AB_CODE      = (CASE WHEN AB_CODE      = '' THEN NULL ELSE AB_CODE    END),"
"        M_S          = (CASE WHEN M_S          = '' THEN NULL ELSE M_S        END),"
"        LIMIT        = (CASE WHEN LIMIT        = '' THEN NULL ELSE LIMIT      END)"
" UPDATE #KRM023_DEDUP"
"   SET CASE_NO      = (CASE WHEN CASE_NO =      '' THEN NULL ELSE CASE_NO END),"
"       INQUIRY_DATE = (CASE WHEN INQUIRY_DATE = '' THEN NULL ELSE INQUIRY_DATE END),"
"       IDN          = (CASE WHEN IDN =          '' THEN NULL ELSE IDN END),"
"       YRMON        = (CASE WHEN YRMON =        '' THEN NULL ELSE YRMON END),"
"       ISSUE        = (CASE WHEN ISSUE =        '' THEN NULL ELSE ISSUE END),"
"       ISSUE_NAME   = (CASE WHEN ISSUE_NAME =   '' THEN NULL ELSE ISSUE_NAME END),"
"       KR_CODE      = (CASE WHEN KR_CODE =      '' THEN NULL ELSE KR_CODE END),"
"       LIMIT        = (CASE WHEN LIMIT =        '' THEN NULL ELSE LIMIT END),"
"       PAYMENT      = (CASE WHEN PAYMENT =      '' THEN NULL ELSE PAYMENT END),"
"       CASH         = (CASE WHEN CASH =         '' THEN NULL ELSE CASH END),"
"       PRE_OWED     = 0.0,"
"       PAY_CODE     = (CASE WHEN PAY_CODE =     '' THEN NULL ELSE PAY_CODE END);"
" UPDATE #STM007_DEDUP"
"   SET CASE_NO     = (CASE WHEN CASE_NO      = '' THEN NULL ELSE CASE_NO END),"
"       INQUIRY_DATE = (CASE WHEN INQUIRY_DATE = '' THEN NULL ELSE INQUIRY_DATE END),"
"       IDN          = (CASE WHEN IDN          = '' THEN NULL ELSE IDN END),"
"       BANK_CODE    = (CASE WHEN BANK_CODE    = '' THEN NULL ELSE BANK_CODE  END),"
"       BANK_NAME    = (CASE WHEN BANK_NAME    = '' THEN NULL ELSE BANK_NAME  END),"
"       QUERY_DATE   = (CASE WHEN QUERY_DATE   = '' THEN NULL ELSE QUERY_DATE END),"
"       ITEM_LIST    = (CASE WHEN ITEM_LIST    = '' THEN NULL ELSE ITEM_LIST  END)"
" UPDATE #BAM086_DEDUP"
"   SET CASE_NO      = (CASE WHEN CASE_NO       = '' THEN NULL ELSE CASE_NO END),"
"       INQUIRY_DATE  = (CASE WHEN INQUIRY_DATE  = '' THEN NULL ELSE INQUIRY_DATE END),"
"       IDN           = (CASE WHEN IDN           = '' THEN NULL ELSE IDN END),"
"       DATA_YYY      = (CASE WHEN DATA_YYY      = '' THEN NULL ELSE DATA_YYY      END),"
"       DATA_MM       = (CASE WHEN DATA_MM       = '' THEN NULL ELSE DATA_MM       END),"
"       BANK_CODE     = (CASE WHEN BANK_CODE     = '' THEN NULL ELSE BANK_CODE     END),"
"       BANK_NAME     = (CASE WHEN BANK_NAME     = '' THEN NULL ELSE BANK_NAME     END),"
"       ACCOUNT_CODE  = (CASE WHEN ACCOUNT_CODE  = '' THEN NULL ELSE ACCOUNT_CODE  END),"
"       ACCOUNT_CODE2 = (CASE WHEN ACCOUNT_CODE2 = '' THEN NULL ELSE ACCOUNT_CODE2 END),"
"       PURPOSE_CODE  = (CASE WHEN PURPOSE_CODE  = '' THEN NULL ELSE PURPOSE_CODE  END),"
"       PAY_CODE_12   = (CASE WHEN PAY_CODE_12   = '' THEN NULL ELSE PAY_CODE_12   END),"
"       CO_LOAN       = (CASE WHEN CO_LOAN       = '' THEN NULL ELSE CO_LOAN       END);"
" UPDATE #KRM037_DEDUP"
"   SET BILL_DATE  = (CASE WHEN LTRIM(BILL_DATE)  = '' THEN NULL ELSE LTRIM(RTRIM(BILL_DATE)) END),"
"       ISSUE      = (CASE WHEN LTRIM(ISSUE)      = '' THEN NULL ELSE ISSUE END),"
"       ISSUE_NAME = (CASE WHEN LTRIM(ISSUE_NAME) = '' THEN NULL ELSE ISSUE_NAME END),"
"       CARD_TYPE  = (CASE WHEN LTRIM(CARD_TYPE)  = '' THEN NULL ELSE CARD_TYPE END),"
"       PERM_LIMIT = (CASE WHEN LTRIM(PERM_LIMIT) = '' THEN NULL ELSE PERM_LIMIT END),"
"       TEMP_LIMIT = (CASE WHEN LTRIM(TEMP_LIMIT) = '' THEN NULL ELSE TEMP_LIMIT END),"
"       CASH_LIMIT = (CASE WHEN LTRIM(CASH_LIMIT) = '' THEN NULL ELSE CASH_LIMIT END),"
"       PAYABLE    = (CASE WHEN LTRIM(PAYABLE)    = '' THEN NULL ELSE PAYABLE END),"
"       CASH_LENT  = (CASE WHEN LTRIM(CASH_LENT)  = '' THEN NULL ELSE CASH_LENT END),"
"       LAST_PAYA  = (CASE WHEN LTRIM(LAST_PAYA)  = '' THEN NULL ELSE LAST_PAYA END),"
"       REVOL_BAL  = (CASE WHEN LTRIM(REVOL_BAL)  = '' THEN NULL ELSE REVOL_BAL END),"
"       PAY_STAT   = (CASE WHEN LTRIM(PAY_STAT)   = '' THEN NULL ELSE PAY_STAT END),"
"       PAY_CODE   = (CASE WHEN LTRIM(PAY_CODE)   = '' THEN NULL ELSE PAY_CODE END),"
"       REVOL_RATE = (CASE WHEN LTRIM(REVOL_RATE) = '' THEN NULL ELSE REVOL_RATE END),"
"       PRE_OWED   = (CASE WHEN LTRIM(PRE_OWED)   = '' THEN NULL ELSE PRE_OWED END),"
"       DEBT_CODE  = (CASE WHEN LTRIM(DEBT_CODE)  = '' THEN NULL ELSE DEBT_CODE END),"
"       CLOSE_CODE = (CASE WHEN LTRIM(CLOSE_CODE) = '' THEN NULL ELSE CLOSE_CODE END),"
"       CLEAR_DATE = (CASE WHEN LTRIM(CLEAR_DATE) = '' THEN NULL ELSE CLEAR_DATE END);"
" INSERT INTO #KRM023_TMP (CASE_NO, IDN, MON_SINCE, ISSUE, ISSUE_NAME, LIMIT, PAYMENT, PAYMENT_AMT, CASH, PAY_CODE, SPREAD_PAYMENT)"
"   SELECT CASE_NO, IDN,"
"          (CASE WHEN LEFT(BILL_DATE,1) = '*' THEN NULL"
"                WHEN LEN(BILL_DATE) = 4 AND LEFT(BILL_DATE,1) BETWEEN '1' AND '9'"
"                     THEN CONVERT(INT, LEFT(BILL_DATE, 2)) * 12 + CONVERT(INT, RIGHT(BILL_DATE, 2))"
"                WHEN LEN(BILL_DATE) = 5 AND LEFT(BILL_DATE,1) BETWEEN '0' AND '9'"
"                     THEN CONVERT(INT, LEFT(BILL_DATE, 3)) * 12 + CONVERT(INT, RIGHT(BILL_DATE, 2))"
"                WHEN LEN(BILL_DATE) = 7"
"                     THEN CONVERT(INT, LEFT(BILL_DATE, 3)) * 12 + CONVERT(INT, SUBSTRING(BILL_DATE, 4, 2))"
"                ELSE NULL END),"
"          (CASE WHEN ISSUE = '021' AND CARD_TYPE = 'V' THEN 'CTV'"
"                WHEN ISSUE = '021' AND CARD_TYPE = 'M' THEN 'CTM'"
"                WHEN ISSUE = '021' AND CARD_TYPE = 'D' THEN 'CTD'"
"                WHEN ISSUE = 'A82' AND CARD_TYPE = 'A' THEN 'AEA'"
"                WHEN ISSUE = 'A82' AND CARD_TYPE = 'E' THEN 'AEE' ELSE ISSUE END),"
"          ISSUE_NAME, PERM_LIMIT, LAST_PAYA, REVOL_BAL / 1000.0,"
"          (CASE WHEN CASH_LENT > 0 THEN 'Y' ELSE 'N' END),"
"          (CASE WHEN PAY_STAT = 'X' AND PAY_CODE = 'X' THEN 'X'"
"                WHEN PAY_STAT = '1' AND PAY_CODE = 'N' THEN 'A'"
"                WHEN PAY_STAT = '1' AND PAY_CODE = '0' THEN 'B'"
"                WHEN PAY_STAT = '2' AND PAY_CODE = 'N' THEN 'C'"
"                WHEN PAY_STAT = '2' AND PAY_CODE = '0' THEN 'D'"
"                WHEN PAY_STAT = '3' AND PAY_CODE BETWEEN '1' AND '7' THEN 'E'"
"                WHEN PAY_STAT = '4' AND PAY_CODE BETWEEN '1' AND '7' THEN 'F'"
"                WHEN DEBT_CODE IN ('A', 'B') THEN 'F' ELSE NULL END),"
"          PRE_OWED / 1000.0"
"   FROM #KRM037_DEDUP;"
" UPDATE #KRM023_TMP"
"   SET PAYMENT_AMT = (CASE RIGHT(PAYMENT,1) WHEN 'L' THEN 2 WHEN 'M' THEN 5 WHEN 'H' THEN 8"
"                      ELSE 0 END) * POWER(10, ISNULL(LEFT(PAYMENT,2),0)-1) / 1000.0"
"   WHERE ((PAYMENT_AMT IS NULL) OR (PAYMENT_AMT = 0))"
" INSERT INTO #KRM023_TMP1 (CASE_NO, IDN, MON_SINCE, ISSUE, ISSUE_NAME, LIMIT, PAYMENT_AMT, CASH, PAY_CODE, SPREAD_PAYMENT)"
"   SELECT CASE_NO, IDN, MON_SINCE, ISSUE, ISSUE_NAME, SUM(CONVERT(INT, LIMIT)), SUM(PAYMENT_AMT),"
"           MAX(CASH), MAX(CASE WHEN PAY_CODE = 'X' THEN '0' ELSE PAY_CODE END), SUM(SPREAD_PAYMENT)"
"   FROM #KRM023_TMP"
"   GROUP BY CASE_NO, IDN, MON_SINCE, ISSUE, ISSUE_NAME"
" UPDATE #KRM023_TMP1"
"   SET CASH = A.CASH"
"   FROM #KRM023_TMP1 AS A INNER JOIN #KRM023_TMP1"
"   ON #KRM023_TMP1.IDN = A.IDN AND"
"      #KRM023_TMP1.MON_SINCE = A.MON_SINCE + 1 AND"
"      #KRM023_TMP1.ISSUE = A.ISSUE AND"
"      #KRM023_TMP1.CASE_NO = A.CASE_NO"
" INSERT INTO #JAS002_T (IDN,  REASON, DATE_HAPPEN)"
"    SELECT IDN, 'D', DELINQUENT_DATE"
"    FROM JAS002"
"    WHERE IDN = @IDN"
"      AND EVER_DELINQUENT = 'Y';"
" INSERT INTO #JAS002_T (IDN,  REASON, DATE_HAPPEN)"
"    SELECT IDN,  'B', BAD_CHECK_DATE"
"    FROM JAS002"
"    WHERE IDN = @IDN"
"      AND EVER_BAD_CHECK = 'Y';"
" INSERT INTO #JAS002_T (IDN,  REASON, DATE_HAPPEN)"
"    SELECT IDN,  'R', REJECT_DATE"
"    FROM JAS002"
"    WHERE IDN = @IDN AND EVER_REJECT = 'Y';"
" INSERT INTO #JAS002_T (IDN,  REASON, DATE_HAPPEN)"
"    SELECT IDN,  'S', STOP_CARD_DATE"
"    FROM JAS002"
"    WHERE IDN = @IDN AND EVER_STOP_CARD = 'Y';"
" INSERT INTO #JAS002_T_DEDUP (IDN,  REASON, DATE_HAPPEN, MON_SINCE, CNT)"
"    SELECT IDN,  REASON, DATE_HAPPEN, MON_SINCE, COUNT(*)"
"    FROM #JAS002_T"
"    GROUP BY IDN,  REASON, DATE_HAPPEN, MON_SINCE;"
" UPDATE #KRM021_DEDUP"
"  SET START_DATE = (CASE WHEN (LEFT(LTRIM(RTRIM(START_DATE)),1) BETWEEN '1' AND '9') AND (LEN(LTRIM(RTRIM(START_DATE)))<7)"
"                         THEN '0' + LTRIM(RTRIM(START_DATE)) ELSE LTRIM(RTRIM(START_DATE)) END),"
"      STOP_DATE =  (CASE WHEN (LEFT(LTRIM(RTRIM(STOP_DATE)),1) BETWEEN '1' AND '9') AND"
"                         (LEN(LTRIM(RTRIM(STOP_DATE)))<7) AND STOP_DATE != '9991231'"
"                          THEN '0' + LTRIM(RTRIM(STOP_DATE)) ELSE LTRIM(RTRIM(STOP_DATE)) END)"
"UPDATE #KRM021_DEDUP SET STOP_DATE = '9991231'"
"  WHERE ((STOP_DATE = '') OR (STOP_DATE IS NULL))"
"UPDATE #KRM021_DEDUP"
"  SET START_MON_SINCE = (CASE WHEN LEFT(START_DATE,1) NOT BETWEEN '0' AND '9' THEN NULL"
"                         ELSE CAST(LEFT(START_DATE, 3) AS INT) * 12 + CAST(RIGHT(LEFT(START_DATE, 5), 2) AS INT) END),"
"      END_MON_SINCE =   (CASE WHEN LEFT(STOP_DATE, 1) NOT BETWEEN '0' AND '9' THEN NULL"
"                         ELSE CAST(LEFT(STOP_DATE, 3) AS INT) * 12 + CAST(RIGHT(LEFT(STOP_DATE, 5), 2) AS INT) END);"
" UPDATE #JAS002_T_DEDUP"
" SET DATE_HAPPEN = (CASE"
" 		    WHEN LEFT(LTRIM(DATE_HAPPEN),1) NOT IN ('1', '0', '*') THEN '0' + (LTRIM(DATE_HAPPEN))"
"  		    ELSE DATE_HAPPEN"
"  		   END);"
" UPDATE #JAS002_T_DEDUP"
" SET MON_SINCE = (CASE"
"    		  WHEN LEFT(LTRIM(DATE_HAPPEN),1) = '*' THEN NULL"
"    		  ELSE CAST(LEFT(LTRIM(DATE_HAPPEN), 3) AS INT) * 12 + CAST(RIGHT(LEFT(RTRIM(DATE_HAPPEN), 5), 2) AS INT)"
"  		 END);"
" UPDATE #KRM023_DEDUP"
" SET YRMON = (CASE"
" 	      WHEN LEFT(LTRIM(RTRIM(YRMON)),1) NOT IN ('1', '0', '*') THEN '0' + LTRIM(RTRIM(YRMON))"
" 	      ELSE LTRIM(RTRIM(YRMON))"
" 	     END);"
" UPDATE #KRM023_DEDUP"
" SET MON_SINCE = (CASE"
" 		   WHEN LEFT(YRMON,1) = '*' THEN NULL"
" 		   ELSE CAST(LEFT(YRMON, 3) AS INT) * 12 + CAST(RIGHT(LEFT(YRMON, 5), 2) AS INT)"
" 		 END);"
" UPDATE #STM007_DEDUP"
"   SET QUERY_DATE = (CASE"
" 		   WHEN LEFT(QUERY_DATE,1) NOT IN ('1', '0', '*') THEN '0' + LTRIM(RTRIM(QUERY_DATE))"
" 		   ELSE QUERY_DATE"
" 		  END);"
" UPDATE #STM007_DEDUP"
"   SET QUERY_MON_SINCE = (CASE"
" 			WHEN LEFT(QUERY_DATE,1) = '*' THEN NULL"
" 			ELSE CAST(LEFT(QUERY_DATE, 3) AS INT) * 12 + CAST(RIGHT(LEFT(QUERY_DATE, 5), 2) AS INT)"
" 		       END);"
" UPDATE #KRM023_DEDUP"
"  SET PAYMENT ="
"   (CASE WHEN RIGHT(LEFT(PAYMENT,2),1) IN ('H', 'M', 'L') THEN '0' + (LEFT(PAYMENT,2))"
"         ELSE PAYMENT END);"
" UPDATE #KRM023_DEDUP"
"  SET PAYMENT_AMT ="
"   (CASE RIGHT(PAYMENT,1) WHEN 'L' THEN 2 WHEN 'M' THEN 5 WHEN 'H' THEN 8"
"   ELSE 0 END) * POWER(10, ISNULL(LEFT(PAYMENT,2),0)-1) / 1000.0;"
" INSERT INTO #KRM023_DEDUP (CASE_NO, IDN, MON_SINCE, ISSUE, ISSUE_NAME, LIMIT, PAYMENT_AMT, CASH, PAY_CODE, PRE_OWED)"
"   SELECT CASE_NO, IDN, MON_SINCE, ISSUE, ISSUE_NAME, LIMIT, PAYMENT_AMT, CASH, PAY_CODE, SPREAD_PAYMENT"
"   FROM #KRM023_TMP1"
"   WHERE MON_SINCE > 1140"
" UPDATE  #KRM023_DEDUP"
" SET BUCKET_DEF_1K = (CASE WHEN PAY_CODE IN ('D', 'E', 'F') AND PAYMENT_AMT > 1 THEN 1"
"                       ELSE 0 END),"
"     BUCKET_EF_1K = (CASE WHEN PAY_CODE IN ('E', 'F') AND PAYMENT_AMT > 1 THEN 1"
"                      ELSE 0 END),"
"     BUCKET_F_1K = (CASE WHEN PAY_CODE = 'F' AND PAYMENT_AMT > 1 THEN 1"
"                     ELSE 0 END);"
" DECLARE @I INT"
" SET @I=12"
" WHILE @I > 0"
" BEGIN"
"   UPDATE #KRM023_DEDUP"
"   SET"
"   BUCKET_DEF_1K =(CASE WHEN #KRM023_DEDUP.PAY_CODE IN ('D', 'E', 'F') AND"
"                             #KRM023_DEDUP.PAYMENT_AMT > 1"
"                        THEN A.BUCKET_DEF_1K + 1"
"                        ELSE 0 END),"
"   BUCKET_EF_1K =(CASE WHEN  #KRM023_DEDUP.PAY_CODE IN ('E', 'F') AND"
"                             #KRM023_DEDUP.PAYMENT_AMT > 1"
"                       THEN A.BUCKET_EF_1K + 1"
"                       ELSE 0 END),"
"   BUCKET_F_1K =(CASE WHEN  #KRM023_DEDUP.PAY_CODE = 'F' AND"
"                            #KRM023_DEDUP.PAYMENT_AMT > 1"
"                      THEN A.BUCKET_F_1K + 1"
"                      ELSE 0 END)"
"   FROM  #KRM023_DEDUP AS A INNER JOIN  #KRM023_DEDUP ON"
"         A.IDN =  #KRM023_DEDUP.IDN AND"
"         A.ISSUE =  #KRM023_DEDUP.ISSUE AND"
"         A.MON_SINCE = ( #KRM023_DEDUP.MON_SINCE - 1)"
"   WHERE (@NOW - A.MON_SINCE) = @I"
" SET @I = @I - 1"
" END;"
""
" UPDATE #BAM086_DEDUP"
"  SET BANK_CODE2 = LEFT(BANK_CODE,3),"
"      MON_SINCE = CAST(DATA_YYY AS INT)* 12 + CAST(DATA_MM AS INT),"
"      CYCLE = LEN(LTRIM(RTRIM(PAY_CODE_12)));"
" SET @I=1;"
" WHILE @I <= 12"
"    BEGIN"
"       INSERT INTO #BAM086_BUCKET (IDN, BANK_CODE, MON_SINCE, BUCKET)"
"          SELECT IDN, BANK_CODE2, (MON_SINCE - @I + 1),"
"                 (CASE WHEN SUBSTRING(RTRIM(PAY_CODE_12), @I, 1) = 'A' THEN 0.25"
"                       WHEN SUBSTRING(RTRIM(PAY_CODE_12), @I, 1) = 'B' THEN 0.5"
"                       WHEN SUBSTRING(RTRIM(PAY_CODE_12), @I, 1) = 'X' THEN 0"
"                       ELSE CONVERT(FLOAT, SUBSTRING(RTRIM(PAY_CODE_12), @I, 1)) END)"
"          FROM #BAM086_DEDUP"
"          WHERE CYCLE >= @I"
"       SET @I = @I + 1"
"    END"
" /* RISK FILTER PROCESS */"
" IF OBJECT_ID('tempdb..#BASE_TMP') IS NOT NULL"
"    DROP TABLE #BASE_TMP;"
" CREATE TABLE #BASE_TMP ("
" 	IDN CHAR (11),"
" 	AVAIL_FLAG INT"
" );"
" INSERT INTO #BASE_TMP(IDN, AVAIL_FLAG)"
"  VALUES (@IDN, 0);"
" INSERT INTO #BASE_TMP(IDN, AVAIL_FLAG)"
"   SELECT DISTINCT IDN, 1"
"   FROM #KRM023_DEDUP;"
" INSERT INTO #BASE_TMP(IDN, AVAIL_FLAG)"
"   SELECT DISTINCT IDN, 2"
"   FROM #KRM021_DEDUP;"
" INSERT INTO #BASE_TMP(IDN, AVAIL_FLAG)"
"   SELECT DISTINCT IDN, 4"
"   FROM #BAM086_DEDUP;"
" INSERT INTO #BASE_TMP(IDN, AVAIL_FLAG)"
"   SELECT DISTINCT IDN, 8"
"   FROM #JAS002_T"
" INSERT INTO #BASE_TMP(IDN, AVAIL_FLAG)"
"   SELECT DISTINCT IDN, 16"
"   FROM #STM007_DEDUP;"
" INSERT INTO #BASE (IDN, AVAIL_FLAG)"
"   SELECT IDN, SUM(AVAIL_FLAG)"
"   FROM #BASE_TMP"
"  GROUP BY IDN;"
" UPDATE #PDACO_V1_00_CAL"
"   SET AVAIL_FLAG = A.AVAIL_FLAG"
"   FROM #BASE A"
"   WHERE A.IDN = #PDACO_V1_00_CAL.IDN;"
" UPDATE #PDACO_V1_00_CAL"
"   SET KRM023_HIT = 1"
"   WHERE AVAIL_FLAG & 0X01 = 0X01;"
" UPDATE #PDACO_V1_00_CAL"
"   SET KRM021_HIT = 1"
"   WHERE AVAIL_FLAG & 0X02 = 0X02;"
" UPDATE #PDACO_V1_00_CAL"
"   SET BAM086_HIT = 1"
"   WHERE AVAIL_FLAG & 0X04 = 0X04;"
" /* UPDATE PRESCREEN VARIABLE*/"
" DELETE FROM #TMP;"
" INSERT INTO #TMP(IDN, V1)"
" SELECT IDN, COUNT(*)"
"   FROM #JAS002_T_DEDUP"
"   WHERE @NOW - MON_SINCE <= 36"
"   GROUP BY IDN;"
" UPDATE #PDACO_V1_00_CAL"
"   SET JAS002_DEFECT = 1"
"   FROM #TMP AS A"
"   WHERE A.IDN = #PDACO_V1_00_CAL.IDN AND"
"         A.V1 > 0;"
" DELETE FROM #TMP;"
" INSERT INTO #TMP(IDN, V1)"
"   SELECT IDN, MAX(BUCKET_EF_1K)"
"   FROM #KRM023_DEDUP"
"   GROUP BY IDN;"
" UPDATE #PDACO_V1_00_CAL"
"   SET MAX_BUCKET = V1"
"   FROM #TMP AS A"
"   WHERE A.IDN = #PDACO_V1_00_CAL.IDN"
" /*----FS044----*/"
" DELETE FROM #TMP;"
" INSERT INTO #TMP (IDN, V1)"
"  SELECT IDN, COUNT(*)"
"  FROM #BAM086_DEDUP"
"  WHERE PASS_DUE_AMT > 0"
"  GROUP BY IDN;"
" UPDATE #PDACO_V1_00_CAL"
"   SET FS044 = V1"
"   FROM #TMP AS A"
"   WHERE A.IDN = #PDACO_V1_00_CAL.IDN;"
" DELETE FROM #TMP;"
" INSERT INTO #TMP (IDN, V1)"
"   SELECT IDN, MAX(BUCKET)"
"     FROM #BAM086_BUCKET"
"     GROUP BY IDN;"
" UPDATE #PDACO_V1_00_CAL"
"   SET FS334 = V1"
"   FROM #TMP AS A"
"   WHERE A.IDN = #PDACO_V1_00_CAL.IDN;"
" DELETE FROM #TMP;"
" INSERT INTO #TMP (IDN, V1)"
"   SELECT IDN, SUM(CASE WHEN ACCOUNT_CODE = 'Y' AND ISNULL(LEFT(PAY_CODE_12,1), '0') NOT IN ('0', 'X')"
"                     THEN 1 ELSE 0 END)"
"   FROM #BAM086_DEDUP"
"   GROUP BY IDN;"
" UPDATE #PDACO_V1_00_CAL"
"   SET fs302 = V1"
"   FROM #TMP AS A"
"   WHERE A.IDN = #PDACO_V1_00_CAL.IDN;"
" /*----CASH CARD MAX BUCKET----*/"
" DELETE FROM #TMP;"
" INSERT INTO #TMP (IDN, V1)"
"   SELECT IDN, COUNT(*)"
"   FROM #BAM086_DEDUP"
"   WHERE ACCOUNT_CODE = 'Y'"
"     AND ISNULL(LEFT(PAY_CODE_12, 1),'0') NOT IN ('0', 'X')"
"   GROUP BY IDN;"
" UPDATE #PDACO_V1_00_CAL"
"   SET CASH_MAX_BUCKET = V1"
"   FROM #TMP AS A"
"   WHERE A.IDN = #PDACO_V1_00_CAL.IDN;"
" /*----CASH CARD UTILIZATION----*/"
" DELETE FROM #TMP;"
" INSERT INTO #TMP (IDN, V1)"
"   SELECT IDN, COUNT(*)"
"   FROM #BAM086_DEDUP"
"   WHERE ACCOUNT_CODE = 'Y'"
"     AND (ISNULL(LOAN_AMT,0)+ ISNULL(PASS_DUE_AMT,0))/ CAST(CONTRACT_AMT AS FLOAT) >= 0.95"
"     AND CONTRACT_AMT > 0"
"   GROUP BY IDN;"
" UPDATE #PDACO_V1_00_CAL"
"   SET CASH_UTILIZATION = V1"
"   FROM #TMP AS A"
"   WHERE A.IDN = #PDACO_V1_00_CAL.IDN;"
" DELETE FROM #TMP;"
" INSERT INTO #TMP (IDN, V1)"
"    SELECT IDN, COUNT(*)"
"    FROM #KRM021_DEDUP"
"    WHERE STOP_CODE = '3' GROUP BY IDN;"
" UPDATE #PDACO_V1_00_CAL"
"   SET CARD_FORCE_STOP = V1"
"   FROM #TMP AS A"
"   WHERE A.IDN = #PDACO_V1_00_CAL.IDN;"
" DELETE FROM #TMP;"
" INSERT INTO #TMP (IDN, MON, V1)"
"   SELECT IDN, 12, COUNT(DISTINCT ISSUE)"
"   FROM #KRM023_DEDUP"
"   WHERE BUCKET_EF_1K >= 1"
"     AND (@NOW - MON_SINCE) <=12"
"   GROUP BY IDN;"
" UPDATE #PDACO_V1_00_CAL"
"   SET FS059_1K_12M = V1"
"   FROM #TMP AS A"
"   WHERE A.IDN = #PDACO_V1_00_CAL.IDN AND MON = 12"
" IF OBJECT_ID('tempdb..#KRM023_RANGE_TMP') IS NOT NULL"
"    DROP TABLE #KRM023_RANGE_TMP;"
" CREATE TABLE #KRM023_RANGE_TMP"
"   (IDN CHAR(11), ISSUE CHAR(3), MON INT);"
" INSERT INTO #KRM023_RANGE_TMP(IDN, ISSUE, MON)"
"   SELECT IDN, ISSUE, MAX(MON_SINCE)"
"   FROM #KRM023_DEDUP"
"   WHERE @NOW - MON_SINCE <= 3"
"   GROUP BY IDN, ISSUE;"
" DELETE FROM #TMP;"
" DELETE FROM #TMP1;"
" INSERT INTO #TMP (IDN, V1, V2)"
"   SELECT A.IDN,"
"        SUM(CASE WHEN PAY_CODE IN ('C', 'D', 'E', 'F') THEN PAYMENT_AMT + PRE_OWED ELSE 0 END),"
"        SUM(CONVERT(FLOAT, LIMIT))"
"   FROM #KRM023_DEDUP AS A, #KRM023_RANGE_TMP AS B"
"   WHERE A.IDN = B.IDN"
"     AND A.ISSUE = B.ISSUE"
"     AND A.MON_SINCE = B.MON"
"   GROUP BY A.IDN;"
" INSERT INTO #TMP1 (IDN, V1)"
"   SELECT IDN, SUM(CAST(ISNULL(LOAN_AMT, 0) AS INT) + CAST(ISNULL(PASS_DUE_AMT, 0) AS INT))"
"     FROM  #BAM086_DEDUP"
"     WHERE ACCOUNT_CODE = 'Y'"
"     GROUP BY IDN;"
" UPDATE #PDACO_V1_00_CAL"
"   SET CARD_REV_BAL = A.V1"
"   FROM #TMP AS A"
"   WHERE A.IDN = #PDACO_V1_00_CAL.IDN;"
" UPDATE #PDACO_V1_00_CAL"
"   SET CASH_REV_BAL = A.V1"
"   FROM #TMP1 AS A"
"   WHERE A.IDN = #PDACO_V1_00_CAL.IDN;"
" UPDATE #PDACO_V1_00_CAL"
"   SET REVOLVING_AMT = CARD_REV_BAL + CASH_REV_BAL;"
" /*----IND001----*/"
" DELETE FROM #TMP;"
" INSERT INTO #TMP (IDN, V1, V2)"
"   SELECT IDN, @NOW - MIN(MON_SINCE), @NOW - MAX(MON_SINCE)"
"   FROM #KRM023_DEDUP"
"   GROUP BY IDN;"
" UPDATE #PDACO_V1_00_CAL"
"   SET IND001 = (CASE WHEN A.V1 < 6 OR A.V2 >= 6 THEN 1 ELSE 0 END)"
"   FROM #TMP AS A"
"   WHERE A.IDN = #PDACO_V1_00_CAL.IDN;"
" DROP TABLE #BASE_TMP;"
" DROP TABLE #KRM023_RANGE_TMP;"
,

/* DROP_PROCEDURE_GENERATE_PDACO_SCORE */
" if exists (select * from dbo.sysobjects where id = object_id(N'[GENERATE_PDACO_SCORE]') and OBJECTPROPERTY(id, N'IsProcedure') = 1)"
" drop procedure GENERATE_PDACO_SCORE;",

/* EXEC_PROCEDURE_GENERATE_PDACO_SCORE */
"Execute GENERATE_PDACO_SCORE :v0;",

/* CREATE_PROCEDURE_GENERATE_PDACO_SCORE */
" CREATE PROCEDURE GENERATE_PDACO_SCORE"
"  (@NOW INT)"
"  AS"
" DECLARE @I INT"
" /* CREATE TEMPORTARY INTERMEDIATE TABLES */"
" /*INIT VARIABLES*/"
" /*INIT STM007 VARIABLES*/"
" UPDATE #PDACO_V1_00_CAL"
"   SET FS031 = 0"
"   FROM #STM007_DEDUP AS A"
"   WHERE A.IDN =#PDACO_V1_00_CAL.IDN;"
" /*INIT BAM086 VARIABLES*/"
" UPDATE #PDACO_V1_00_CAL"
"   SET FS051 = 0"
"   FROM #BAM086_DEDUP AS A"
"   WHERE A.IDN =#PDACO_V1_00_CAL.IDN;"
" /*INIT KRM023 VARIABLES*/"
" UPDATE #PDACO_V1_00_CAL"
" SET FS102_3M = 0,"
"     FS102_6M = 0,"
"     FS102_9M = 0,"
"     FS005_1K_3M = 0,"
"     FS059_1K_3M = 0,"
"     FS059_1K_6M = 0,"
"     FS059_1K_9M = 0,"
"     FS014_9M = 0,"
"     FS016_3M = 0,"
"     FS101_3M = 0,"
"     FS101_9M = 0,"
"     MS117_6M = 0"
" FROM #KRM023_DEDUP AS A"
" WHERE A.IDN = #PDACO_V1_00_CAL.IDN;"
" /*INIT KRM021 AND KRM023 VARIABLES*/"
" UPDATE #PDACO_V1_00_CAL"
"   SET FS205_1K_3M = 0,"
"       FS212_1K_3M = 0,"
"       FS212_1K_6M = 0"
"   FROM #KRM021_DEDUP AS A, #KRM023_DEDUP AS B"
"   WHERE A.IDN = B.IDN"
"     AND A.IDN = #PDACO_V1_00_CAL.IDN"
"     AND ((A.ISSUE = B.ISSUE)"
"           OR ((A.ISSUE = '021' AND A.CARD_BRAND = 'V') AND (B.ISSUE = 'CTV'))"
"           OR ((A.ISSUE = '021' AND A.CARD_BRAND = 'M') AND (B.ISSUE = 'CTM'))"
"           OR ((A.ISSUE = '021' AND A.CARD_BRAND = 'D') AND (B.ISSUE = 'CTD'))"
"           OR ((A.ISSUE = 'A82' AND A.CARD_BRAND = 'A') AND (B.ISSUE = 'AEA'))"
"         );"
" /* FT102_42_R_TRAN3	???????H???B???? (LINE > $100K) */"
" /*---INIT TEMP TABLE----*/"
" DELETE FROM #OPEN_ISSUE;"
" DELETE FROM #TMP;"
" DELETE FROM #TMP1;"
" /*---START MAKING FS102---*/"
" INSERT INTO #OPEN_ISSUE (IDN, MON, ISSUE)"
"   SELECT IDN, MON_SINCE, ISSUE"
"   FROM #KRM023_DEDUP"
"   WHERE LIMIT > 100;"
" SET @I = 3"
" WHILE @I<=9"
"  BEGIN"
"    INSERT INTO #TMP (IDN, MON, V1)"
"      SELECT DISTINCT IDN, @I, 0"
"      FROM #KRM023_DEDUP"
"      WHERE (@NOW - MON_SINCE) <= @I"
"      GROUP BY IDN"
"    SET @I = @I + 3"
"  END"
" SET @I = 3"
" WHILE @I<=9"
"  BEGIN"
"    INSERT INTO #TMP1 (IDN, MON, V1)"
"      SELECT IDN, @I, COUNT(DISTINCT ISSUE)"
"      FROM #OPEN_ISSUE"
"      WHERE (@NOW - MON) <= @I"
"      GROUP BY IDN"
"    SET @I = @I + 3"
"  END"
" UPDATE #TMP"
"   SET V1 = A.V1"
"   FROM #TMP1 AS A"
"   WHERE A.IDN = #TMP.IDN"
"     AND #TMP.MON = A.MON"
" UPDATE #PDACO_V1_00_CAL"
"   SET FS102_3M = V1"
"   FROM #TMP AS A"
"   WHERE A.IDN = #PDACO_V1_00_CAL.IDN AND MON = 3"
" UPDATE #PDACO_V1_00_CAL"
"   SET FS102_6M = V1"
"   FROM #TMP AS A"
"   WHERE A.IDN = #PDACO_V1_00_CAL.IDN AND MON = 6"
" UPDATE #PDACO_V1_00_CAL"
"   SET FS102_9M = V1"
"   FROM #TMP AS A"
"   WHERE A.IDN = #PDACO_V1_00_CAL.IDN AND MON = 9"
" /* FS031_TRAN	JCIC?D?????? (ALL) (STM007) */"
" DELETE FROM #TMP"
" /*---START MAKING FS031---*/"
" /*JCIC?D??????WITHIN 4 MONTH FROM THE INQUIRY DATE (CREDIT CARD ), NO 15 DAY RULE*/"
" INSERT INTO #TMP (IDN, V1)"
"   SELECT IDN, COUNT(*)"
"   FROM #STM007_DEDUP"
"   WHERE ITEM_LIST IS NOT NULL"
"     AND ITEM_LIST <> ''"
"     AND (@NOW - QUERY_MON_SINCE) <= 3"
"   GROUP BY IDN"
" UPDATE #PDACO_V1_00_CAL"
"   SET FS031 = V1"
"   FROM #TMP AS A"
"   WHERE A.IDN = #PDACO_V1_00_CAL.IDN"
""
" /* FS005_1K_3M	?????????????? (M2+) - PAY CODE IN ('F') */"
" DELETE FROM #TMP"
" DELETE FROM #TMP1"
" /*---START MAKING FS005---*/"
" INSERT INTO #TMP1(IDN, MON, V1)"
"  SELECT IDN, MON_SINCE, 1"
"  FROM #KRM023_DEDUP"
"  WHERE BUCKET_F_1K >=2"
"  GROUP BY IDN, MON_SINCE"
" INSERT INTO #TMP (IDN, MON, V1)"
"  SELECT IDN, 3, COUNT(*)"
"  FROM #TMP1"
"  WHERE (@NOW - MON) <= 3"
"  GROUP BY IDN"
""
" UPDATE #PDACO_V1_00_CAL"
"   SET FS005_1K_3M = V1"
"   FROM #TMP AS A"
"   WHERE A.IDN = #PDACO_V1_00_CAL.IDN"
"     AND MON = 3"
" /* SEX_TRAN	GENDER */"
" UPDATE #PDACO_V1_00_CAL"
"   SET SEX = SUBSTRING(IDN, 2, 1)"
" /* APP_LAST_MONTH_BUCKET_TRAN	LAST MONTH MAX AMONG ALL LINES */"
" DELETE FROM #TMP"
" INSERT INTO #TMP (IDN, V1)"
"   SELECT IDN, MAX(BUCKET_EF_1K)"
"   FROM #KRM023_DEDUP"
"   WHERE (@NOW - MON_SINCE) <= 1  /*MAX BUCKET FOR LAST 2 MONTHS, NO 15 DAY RULE*/"
"   GROUP BY IDN;"
" UPDATE #PDACO_V1_00_CAL"
"   SET APP_LAST_MONTH_BUCKET = V1"
"   FROM #TMP A"
"   WHERE A.IDN = #PDACO_V1_00_CAL.IDN;"
" /*---OPEN_CARD AND OPEN_LINE CONTAIN MONTHS WHICH SHOULD HAVE TRANSACTION RECORDS BASED ON"
"     KRM001, OPEN_LINE CONTAINS ONE RECORD FOR EACH CREDIT LINE EACH MONTH. ONE-CARD-ONE-LINE"
"     ISSUERS, I.E. 021(CITI) IS PROCESSED SEPERATELY.  THE OTHER TWO ONE-CARD-ONE-LINE ISSUERS,"
"     I.E. 081(HSBC) ,974(AIG), FOR THEIR KRM023 DATA ARE CONSOLIDATED, ARE TREATED AS"
"     MULTI-CARD-ONE-LINE ISSERS---*/"
" /* ---PREPARE INTERMEDIATE TABLES FOR KRM023 AND KRM021 VARIABLES --- */"
"   SET @I = 0"
"   WHILE @I <= 13"
"    BEGIN"
"     INSERT INTO #OPEN_CARD (IDN, ISSUE, MON)"
"      SELECT IDN,"
"             (CASE WHEN CARD_BRAND = 'A' AND ISSUE = 'A82' THEN 'AEA'"
"                   ELSE ISSUE END),"
"             (@NOW - @I)"
"      FROM #KRM021_DEDUP"
"      WHERE (END_MON_SINCE > (@NOW - @I))"
"        AND (START_MON_SINCE <= (@NOW - @I))"
"        AND ISSUE != '021'"
"     SET @I = @I + 1"
"    END;"
"   INSERT INTO #OPEN_LINE (IDN, ISSUE, MON, CARDS)"
"    SELECT IDN, ISSUE, MON, COUNT(*)"
"    FROM #OPEN_CARD"
"    GROUP BY IDN, ISSUE, MON;"
"   SET @I = 0"
"   WHILE @I <= 13"
"    BEGIN"
"     INSERT INTO #OPEN_LINE (IDN, ISSUE, MON, CARDS)"
"      SELECT IDN,"
"             (CASE WHEN CARD_BRAND = 'M' THEN 'CTM'"
"                   WHEN CARD_BRAND = 'V' THEN 'CTV'"
"                   WHEN CARD_BRAND = 'D' THEN 'CTD' END),"
"             (@NOW - @I),"
"             1"
"      FROM #KRM021_DEDUP"
"      WHERE (END_MON_SINCE > (@NOW - @I))"
"        AND (START_MON_SINCE <= (@NOW - @I))"
"        AND ISSUE = '021'"
"     SET @I = @I + 1"
"    END;"
"   UPDATE #OPEN_LINE"
"    SET BUCKET = 1;"
" /*ARBITRARY NUMBER, JUST TO MAKE SURE IT WILL OUT-OF-RANGE*/"
"   UPDATE #OPEN_LINE"
"    SET BUCKET = 100  /*ARBITRARY NUMBER, JUST TO MAKE SURE IT WILL OUT-OF-RANGE*/"
"    WHERE MON = (@NOW - 13);"
"   SET @I = 13;"
"   WHILE @I > 0"
"    BEGIN"
"     UPDATE #OPEN_LINE"
"      SET BUCKET = A.BUCKET + 1"
"      FROM #OPEN_LINE AS A INNER JOIN #OPEN_LINE"
"        ON A.IDN = #OPEN_LINE.IDN"
"       AND A.ISSUE = #OPEN_LINE.ISSUE"
"       AND A.MON = (#OPEN_LINE.MON - 1)"
"      WHERE (@NOW - A.MON) = @I"
"     SET @I = @I - 1"
"    END;"
"   INSERT INTO #LATEST_STMT_MON (IDN, ISSUE, MON)"
"    SELECT IDN, ISSUE, MAX(MON)"
"    FROM #OPEN_LINE"
"    WHERE MON <= @NOW"
"    GROUP BY IDN, ISSUE;"
"   INSERT INTO #LATEST_LINE (IDN, ISSUE, MON, MOB)"
"    SELECT A.IDN, A.ISSUE, A.MON, A.BUCKET"
"    FROM #OPEN_LINE AS A INNER JOIN #LATEST_STMT_MON AS B"
"      ON A.IDN = B.IDN"
"     AND A.ISSUE = B.ISSUE"
"     AND A.MON = B.MON;"
""
" /* FS205_1K_3M_Q_TRAN	# OF DELINQUNT LINES OPENED LESS THAN A YEAR */"
" /*----FS205_1K----*/"
" DELETE FROM #TMP;"
" INSERT INTO #TMP (IDN, MON, V1)"
"   SELECT IDN, 3, COUNT(*)"
"   FROM #KRM023_DEDUP AS A"
"   WHERE ISSUE IN"
"   (SELECT ISSUE FROM #LATEST_LINE"
"    WHERE MOB <= 12 AND IDN = A.IDN)"
"      AND PAY_CODE IN ('C', 'D', 'E', 'F')"
"      AND PAYMENT_AMT > 1"
"      AND (@NOW - MON_SINCE) <= 3"
"   GROUP BY IDN;"
" UPDATE #PDACO_V1_00_CAL"
"   SET FS205_1K_3M = V1"
"   FROM #TMP AS A"
"   WHERE A.IDN = #PDACO_V1_00_CAL.IDN"
"     AND A.MON = 3;"
" /* FT059_1K_43_R_TRAN	???????????B???? (M1+) - PAY CODE IN ('E','F') */"
" /* FT059_1K_42_Q_TRAN	???????????B???? (M1+) - PAY CODE IN ('E','F') */"
" DELETE FROM #TMP1"
" /*---START MAKING FS059---*/"
" SET @I = 3"
" WHILE @I <= 9"
" BEGIN"
"   INSERT INTO #TMP1 (IDN, MON, V1)"
"   SELECT IDN, @I, COUNT(DISTINCT ISSUE)"
"   FROM #KRM023_DEDUP"
"   WHERE BUCKET_EF_1K >= 1"
"     AND (@NOW - MON_SINCE) <= @I"
"   GROUP BY IDN"
" SET @I = @I + 3"
" END"
" UPDATE #PDACO_V1_00_CAL"
"   SET FS059_1K_3M = V1"
"   FROM #TMP1 AS A"
"   WHERE A.IDN = #PDACO_V1_00_CAL.IDN AND MON = 3;"
" UPDATE #PDACO_V1_00_CAL"
"   SET FS059_1K_6M = V1"
"   FROM #TMP1 AS A"
"   WHERE A.IDN = #PDACO_V1_00_CAL.IDN AND MON = 6;"
" UPDATE #PDACO_V1_00_CAL"
"   SET FS059_1K_9M = V1"
"   FROM #TMP1 AS A"
"   WHERE A.IDN = #PDACO_V1_00_CAL.IDN AND MON = 9;"
" /* FS051_TRAN	?G?????U?????? */"
" DELETE FROM #TMP"
" /*---START MAKING FS051---*/"
" INSERT INTO #TMP (IDN, V1)"
"   SELECT IDN, COUNT(*)"
"   FROM #BAM086_DEDUP"
"   WHERE PURPOSE_CODE = '4'"
"   GROUP BY IDN;"
" UPDATE #PDACO_V1_00_CAL"
"   SET FS051 = V1"
"   FROM #TMP AS A"
"   WHERE A.IDN = #PDACO_V1_00_CAL.IDN;"
" /* INT015_3M_TRAN	EVER ?W???{???B????(FS016) / ???????H???B????(FS101) */"
" DELETE FROM #TMP;"
" DELETE FROM #TMP1;"
" /*---START MAKING FS016---*/"
" INSERT INTO #TMP (IDN, MON, V1)"
"   SELECT IDN, 3, COUNT(DISTINCT ISSUE)"
"   FROM #KRM023_DEDUP"
"   WHERE (@NOW - MON_SINCE) <= 3"
"     AND CASH = 'Y'"
"   GROUP BY IDN;"
" UPDATE #PDACO_V1_00_CAL"
"   SET FS016_3M = V1"
"   FROM #TMP AS A"
"   WHERE A.IDN = #PDACO_V1_00_CAL.IDN AND MON = 3;"
" /*---START MAKING FS101---*/"
" INSERT INTO #TMP1 (IDN, MON, V1)"
"   SELECT IDN, 3, COUNT(DISTINCT ISSUE)"
"   FROM #KRM023_DEDUP"
"   WHERE (@NOW - MON_SINCE) <= 3"
"   GROUP BY IDN;"
" UPDATE #PDACO_V1_00_CAL"
"   SET FS101_3M = V1"
"   FROM #TMP1 AS A"
"   WHERE A.IDN = #PDACO_V1_00_CAL.IDN AND MON = 3;"
" /* FT212_1K_43_Q_TRAN2	MONTHLY AVERAGE # OF DELINQUNT LINES THAT ARE OPENED LESS THAN 6 MONTHS */"
" DELETE FROM #TMP;"
" DELETE FROM #TMP1;"
" SET @I = 1"
" WHILE @I <= 12"
" BEGIN"
"  INSERT INTO #TMP (IDN, MON, V1)"
"    SELECT IDN, @I, COUNT(*)"
"    FROM #KRM023_DEDUP AS A"
"    WHERE ISSUE IN"
"      (SELECT ISSUE FROM #LATEST_LINE"
"       WHERE  (MON - MOB + 1) >=  (@NOW - 6) AND IDN = A.IDN)"
"     AND PAY_CODE IN ('C', 'D', 'E', 'F')"
"     AND PAYMENT_AMT > 1"
"     AND (@NOW - MON_SINCE) = @I"
"    GROUP BY IDN"
" SET @I = @I + 1"
" END"
" SET @I = 3"
" WHILE @I <= 6"
" BEGIN"
"   INSERT INTO #TMP1 (IDN, MON, V1)"
"   SELECT IDN, @I, AVG(V1)"
"   FROM #TMP"
"   WHERE MON <= @I"
"     AND MON > 0"
"   GROUP BY IDN"
" SET @I = @I + 3"
" END"
" UPDATE #PDACO_V1_00_CAL"
"   SET FS212_1K_3M = V1"
"   FROM #TMP1 AS A"
"   WHERE A.IDN = #PDACO_V1_00_CAL.IDN"
"     AND A.MON = 3"
" UPDATE #PDACO_V1_00_CAL"
"   SET FS212_1K_6M = V1"
"   FROM #TMP1 AS A"
"   WHERE A.IDN = #PDACO_V1_00_CAL.IDN"
"     AND A.MON = 6"
" /* MS117_6M	???C?`???????? (MIN OF ALL LINE)PAYCODE CD */"
" DELETE FROM #TMP"
" /*---START MAKING MS117---*/"
" INSERT INTO #TMP (IDN, MON, V1)"
"   SELECT IDN, 6, MIN(PAYMENT_AMT/CONVERT(DECIMAL(13,5),LIMIT))"
"   FROM #KRM023_DEDUP"
"   WHERE (@NOW - MON_SINCE) <= 6"
"     AND (@NOW - MON_SINCE) > 0  /*KEEP 15-DAY RULE*/"
"     AND PAY_CODE IN ('C', 'D')"
"     AND LIMIT <> 0"
"   GROUP BY IDN;"
" UPDATE #PDACO_V1_00_CAL"
"   SET MS117_6M = V1"
"   FROM #TMP AS A"
"   WHERE A.IDN = #PDACO_V1_00_CAL.IDN AND MON=6;"
" /* INT028_9_TRAN	???D???I?M?B????(PAYCODE A,B, FS014)/FS101 ???????H???B???? (ALL OPENED) */"
" DELETE FROM #TMP"
" DELETE FROM #TMP1"
" /*---START MAKING FS014---*/"
" INSERT INTO #TMP (IDN, MON, V1)"
"   SELECT IDN, 9, COUNT(DISTINCT ISSUE)"
"   FROM #KRM023_DEDUP"
"   WHERE (@NOW - MON_SINCE) <= 9"
"     AND PAY_CODE IN ('A', 'B')"
"   GROUP BY IDN;"
" UPDATE #PDACO_V1_00_CAL"
"   SET FS014_9M = V1"
"   FROM #TMP AS A"
"   WHERE A.IDN = #PDACO_V1_00_CAL.IDN AND MON=9;"
" /*---START MAKING FS101---*/"
" INSERT INTO #TMP1 (IDN, MON, V1)"
"   SELECT IDN, 9, COUNT(DISTINCT ISSUE)"
"   FROM #KRM023_DEDUP"
"   WHERE (@NOW - MON_SINCE) <= 9"
"   GROUP BY IDN;"
" UPDATE #PDACO_V1_00_CAL"
"   SET FS101_9M = V1"
"   FROM #TMP1 AS A"
"   WHERE A.IDN = #PDACO_V1_00_CAL.IDN AND MON = 9;"
" UPDATE #PDACO_V1_00_CAL"
"   SET FT102_42 = FS102_3M - (FS102_9M - FS102_6M),"
"       INT015_3 = (CASE WHEN FS101_3M = 0 THEN NULL ELSE FS016_3M / FS101_3M END),"
"       FT059_1K_43 = FS059_1K_3M - (FS059_1K_6M - FS059_1K_3M),"
"       FT059_1K_42 = FS059_1K_3M - (FS059_1K_9M - FS059_1K_6M),"
"       FT212_1K_43 = FS212_1K_3M - (FS212_1K_6M - FS212_1K_3M),"
"       INT028_9 = (CASE WHEN FS101_9M = 0 THEN NULL ELSE FS014_9M / FS101_9M END);"
" UPDATE #PDACO_V1_00_CAL"
"   SET FT059_1K_43_R = POWER((CASE WHEN FT059_1K_43 < 0 THEN NULL ELSE FT059_1K_43 END), 0.5),"
"       FT059_1K_42_Q = POWER (FT059_1K_42, 2),"
"       FT102_42_R = POWER((CASE WHEN FT102_42 < 0 THEN NULL ELSE FT102_42 END), 0.5),"
"       FT212_1K_43_Q = POWER (FT212_1K_43, 2),"
"       FS205_1K_3M_Q = POWER (FS205_1K_3M, 2);"
" UPDATE #PDACO_V1_00_CAL"
"   SET INT015_3_TRAN = (CASE WHEN INT015_3 IS NULL THEN 1"
"      			    WHEN INT015_3 > 1 THEN 1"
"      			    ELSE INT015_3 END),"
"       FT102_42_R_TRAN = (CASE WHEN FT102_42_R IS NULL THEN -0.2"
"      			    WHEN FT102_42_R > 1.7 THEN 1.7"
"      			    ELSE FT102_42_R END),"
"       FT212_1K_43_Q_TRAN = (CASE WHEN FT212_1K_43_Q IS NULL THEN 0"
"      			    ELSE FT212_1K_43_Q END),"
"       FT059_1K_42_Q_TRAN = (CASE WHEN FT059_1K_42_Q > 16 THEN 16"
"      			       ELSE FT059_1K_42_Q END),"
"       FS031_TRAN = (CASE WHEN FS031 IS NULL THEN -1"
"      		       WHEN FS031 > 9 THEN 9"
"      		       ELSE FS031 END),"
"       SEX_TRAN = (CASE WHEN SEX = 1 THEN 1 ELSE 0 END),"
"       APP_LAST_MONTH_BUCKET_TRAN = (CASE WHEN APP_LAST_MONTH_BUCKET IS NULL THEN 1"
"      			    WHEN APP_LAST_MONTH_BUCKET > 2 THEN 2"
"      			    ELSE APP_LAST_MONTH_BUCKET END),"
"       FS205_1K_3M_Q_TRAN = (CASE WHEN FS205_1K_3M_Q IS NULL THEN 0"
"      		       WHEN FS205_1K_3M_Q > 60 THEN 60"
"      		       ELSE FS205_1K_3M_Q END),"
"       INT028_9_TRAN = (CASE WHEN INT028_9 IS NULL THEN 0.3"
"      		       WHEN INT028_9 > 0.3 THEN 0.3"
"      		       ELSE INT028_9 END),"
"       FT059_1K_43_R_TRAN = (CASE WHEN FT059_1K_43_R IS NULL THEN 1"
"      			       ELSE FT059_1K_43_R END),"
"       FS051_TRAN = (CASE WHEN FS051 IS NULL THEN 2"
"      		       WHEN FS051 > 5 THEN 5"
"      		       ELSE FS051 END);"
" UPDATE #PDACO_V1_00_CAL"
"   SET PDACO_SCORE= 0.01474		+"
"   	     INT015_3_TRAN		*	0.04190 +"
"   	     FT059_1K_42_Q_TRAN		*	0.00964 +"
"   	     FT212_1K_43_Q_TRAN		*	0.01186 +"
"   	     FT102_42_R_TRAN		*	-0.02683 +"
"   	     FS031_TRAN			*	0.00573 +"
"   	     MS117_6M			*	0.04292 +"
"   	     FS005_1K_3M		*	0.12726 +"
"   	     SEX_TRAN 			*	0.02654 +"
"   	     APP_LAST_MONTH_BUCKET_TRAN	*	0.05866 +"
"   	     FS205_1K_3M_Q_TRAN		*	0.00058973 +"
"   	     INT028_9_TRAN		*	-0.08045 +"
"   	     FT059_1K_43_R_TRAN		*	0.01873 +"
"   	     FS051_TRAN 		*	0.00345;"
" UPDATE #PDACO_V1_00_CAL"
"   SET PDACO_TWEN = (CASE"
"                     WHEN PDACO_SCORE IS NULL THEN 0"
"                     WHEN PDACO_SCORE <= -0.03231 THEN 1"
"                     WHEN PDACO_SCORE <= -0.02275 THEN 2"
"                     WHEN PDACO_SCORE <= -0.01479 THEN 3"
"                     WHEN PDACO_SCORE <= -0.00919 THEN 4"
"                     WHEN PDACO_SCORE <= -0.00438 THEN 5"
"                     WHEN PDACO_SCORE <= 0.00101 THEN 6"
"                     WHEN PDACO_SCORE <= 0.00624 THEN 7"
"                     WHEN PDACO_SCORE <= 0.01245 THEN 8"
"                     WHEN PDACO_SCORE <= 0.01836 THEN 9"
"                     WHEN PDACO_SCORE <= 0.02482 THEN 10"
"                     WHEN PDACO_SCORE <= 0.03219 THEN 11"
"                     WHEN PDACO_SCORE <= 0.03963 THEN 12"
"                     WHEN PDACO_SCORE <= 0.04759 THEN 13"
"                     WHEN PDACO_SCORE <= 0.05585 THEN 14"
"                     WHEN PDACO_SCORE <= 0.06657 THEN 15"
"                     WHEN PDACO_SCORE <= 0.07865 THEN 16"
"                     WHEN PDACO_SCORE <= 0.09435 THEN 17"
"                     WHEN PDACO_SCORE <= 0.11509 THEN 18"
"                     WHEN PDACO_SCORE <= 0.15002 THEN 19"
"                     ELSE 20"
"   		  END)"
" UPDATE #PDACO_V1_00_CAL"
"   SET PB_IN = (CASE"
"                WHEN PDACO_TWEN = 0  THEN NULL"
"                WHEN PDACO_TWEN = 1  THEN 0.0070"
"                WHEN PDACO_TWEN = 2  THEN 0.0080"
"                WHEN PDACO_TWEN = 3  THEN 0.0095"
"                WHEN PDACO_TWEN = 4  THEN 0.0105"
"                WHEN PDACO_TWEN = 5  THEN 0.0120"
"                WHEN PDACO_TWEN = 6  THEN 0.0135"
"                WHEN PDACO_TWEN = 7  THEN 0.0155"
"                WHEN PDACO_TWEN = 8  THEN 0.0175"
"                WHEN PDACO_TWEN = 9  THEN 0.0205"
"                WHEN PDACO_TWEN = 10 THEN 0.0235"
"                WHEN PDACO_TWEN = 11 THEN 0.0265"
"                WHEN PDACO_TWEN = 12 THEN 0.0300"
"                WHEN PDACO_TWEN = 13 THEN 0.0340"
"                WHEN PDACO_TWEN = 14 THEN 0.0385"
"                WHEN PDACO_TWEN = 15 THEN 0.0430"
"                WHEN PDACO_TWEN = 16 THEN 0.0500"
"                WHEN PDACO_TWEN = 17 THEN 0.0640"
"                WHEN PDACO_TWEN = 18 THEN 0.0885"
"                WHEN PDACO_TWEN = 19 THEN 0.1190"
"                WHEN PDACO_TWEN = 20 THEN 0.1800"
"     	     END);"
" DELETE FROM #TMP;"
" INSERT INTO #TMP (IDN, V1)"
"   SELECT IDN,"
"          SUM(CASE"
"             WHEN ACCOUNT_CODE = 'C' AND ((ACCOUNT_CODE2 IS NULL) OR (ACCOUNT_CODE2 = '') OR (ACCOUNT_CODE2 = 'N')) THEN (CONTRACT_AMT) / 10.0 * 150 / 1000.0"
"             WHEN ACCOUNT_CODE = 'C' AND ACCOUNT_CODE2 IN ('S', 'W', 'M') THEN (CONTRACT_AMT) / 10.0 * 100 / 1000.0"
"             WHEN ACCOUNT_CODE = 'E' AND ((ACCOUNT_CODE2 IS NULL) OR (ACCOUNT_CODE2 = '') OR (ACCOUNT_CODE2 = 'N')) THEN (CONTRACT_AMT) / 10.0 * 150 / 1000.0"
"             WHEN ACCOUNT_CODE = 'E' AND ACCOUNT_CODE2 IN ('S', 'W', 'M') THEN (CONTRACT_AMT) / 10.0 * 100 / 1000.0"
"             WHEN ACCOUNT_CODE = 'H' AND ((ACCOUNT_CODE2 IS NULL) OR (ACCOUNT_CODE2 = '') OR (ACCOUNT_CODE2 = 'N')) THEN (CONTRACT_AMT) / 10.0 * 238 / 1000.0"
"             WHEN ACCOUNT_CODE = 'H' AND ACCOUNT_CODE2 IN ('S', 'W', 'M') THEN (CONTRACT_AMT) / 10.0 * 177 / 1000.0"
"             WHEN ACCOUNT_CODE = 'I' AND ((ACCOUNT_CODE2 IS NULL) OR (ACCOUNT_CODE2 = '') OR (ACCOUNT_CODE2 = 'N')) THEN (CONTRACT_AMT) / 10.0 * 127 / 1000.0"
"             WHEN ACCOUNT_CODE = 'I' AND ACCOUNT_CODE2 IN ('S', 'W', 'M') THEN (CONTRACT_AMT) / 10.0 * 72 / 1000.0"
"             WHEN ACCOUNT_CODE = 'O' AND ((ACCOUNT_CODE2 IS NULL) OR (ACCOUNT_CODE2 = '') OR (ACCOUNT_CODE2 = 'N')) THEN (CONTRACT_AMT) / 10.0 * 177 / 1000.0"
"             WHEN ACCOUNT_CODE = 'O' AND ACCOUNT_CODE2 IN ('S', 'W', 'M') THEN (CONTRACT_AMT) / 10.0 * 238 / 1000.0"
"             WHEN ACCOUNT_CODE = 'K' THEN (CONTRACT_AMT) / 10.0 * 17 / 1000.0"
"             WHEN ACCOUNT_CODE = 'Z' THEN (CONTRACT_AMT) / 10.0 * 213 / 1000.0"
"           END)"
"   FROM #BAM086_DEDUP"
"   GROUP BY IDN;"
" UPDATE #PDACO_V1_00_CAL"
"   SET MS093 = V1"
"   FROM #TMP AS A"
"   WHERE A.IDN = #PDACO_V1_00_CAL.IDN;"
" DELETE FROM #TMP;"
" INSERT INTO #TMP(IDN, MON, V1)"
"    SELECT IDN, MON_SINCE, SUM(PAYMENT_AMT)"
"    FROM #KRM023_DEDUP"
"    WHERE PAY_CODE IN ('C', 'D', 'E', 'F')"
"      AND MON_SINCE >= @NOW - 3"
"      AND MON_SINCE <= @NOW"
"    GROUP BY IDN, MON_SINCE;"
" UPDATE #PDACO_V1_00_CAL"
"    SET MS094 = A.V1"
"    FROM (SELECT IDN, AVG(V1) AS V1"
"          FROM #TMP"
"          GROUP BY IDN) AS A"
"    WHERE A.IDN = #PDACO_V1_00_CAL.IDN;"
" UPDATE #PDACO_V1_00_CAL"
"       SET MS105 ="
"           (SELECT SUM(LOAN_AMT + PASS_DUE_AMT)"
"            FROM #BAM086_DEDUP S"
"            WHERE ACCOUNT_CODE = 'Y'"
"              AND #PDACO_V1_00_CAL.IDN = S.IDN"
"            GROUP BY S.IDN)"
"       WHERE EXISTS (SELECT *"
"                     FROM #BAM086_DEDUP S"
"                     WHERE ACCOUNT_CODE = 'Y'"
"                       AND #PDACO_V1_00_CAL.IDN = S.IDN);"
" UPDATE #PDACO_V1_00_CAL SET MS101 = MS093 + (MS094 + MS105) * 0.35;"
,
/* Insert_Audit_Table */
" if not exists (select * from dbo.sysobjects where id = object_id(N'DAC_AUDIT') and objectproperty(id, N'isusertable') = 1)"
"  create table DAC_AUDIT ("
"	CASE_NO VARCHAR(20),"
"	IDN CHAR (11),"
"	INQUIRY_DATE CHAR(8),"
"	NOW INT,"
"	AVAIL_FLAG INT,"
"	JAS002_DEFECT INT,"
"	KRM021_HIT INT,"
"	KRM023_HIT INT,"
"	BAM086_HIT INT,"
"	MAX_BUCKET INT,"
"	FS044 INT,"
"	FS059_1K_12M	INT,"
"	FS302 INT,"
"	FS334 INT,"
"	CARD_FORCE_STOP INT,"
"	CASH_MAX_BUCKET INT,"
"	CASH_UTILIZATION INT,"
"	IND001 INT,"
"	CARD_REV_BAL FLOAT,"
"	CASH_REV_BAL FLOAT,"
"	REVOLVING_AMT FLOAT,"
"	FS102_3M	DECIMAL(16,8),"
"	FS102_6M	DECIMAL(16,8),"
"	FS102_9M	DECIMAL(16,8),"
"	FT102_42	DECIMAL(16,8),"
"	FT102_42_R	DECIMAL(16,8),"
"	FT102_42_R_TRAN	DECIMAL(16,8),"
"	FS031		DECIMAL(16,8),"
"	FS031_TRAN	DECIMAL(16,8),"
"	FS005_1K_3M	DECIMAL(16,8),"
"	FS005_1K_3M_Q	DECIMAL(16,8),"
"	FS005_1K_3M_Q_TRAN	DECIMAL(16,8),"
"	FS059_1K_3M	DECIMAL(16,8),"
"	FS059_1K_6M	DECIMAL(16,8),"
"	FS059_1K_9M	DECIMAL(16,8),"
"	FT059_1K_43	DECIMAL(16,8),"
"	FT059_1K_43_R	DECIMAL(16,8),"
"	FT059_1K_43_R_TRAN	DECIMAL(16,8),"
"	FT059_1K_42	DECIMAL(16,8),"
"	FT059_1K_42_Q	DECIMAL(16,8),"
"	FT059_1K_42_Q_TRAN	DECIMAL(16,8),"
"	FS051		DECIMAL(16,8),"
"	FS051_TRAN	DECIMAL(16,8),"
"	FS016_3M	DECIMAL(16,8),"
"	FS101_3M	DECIMAL(16,8),"
"	INT015_3	DECIMAL(16,8),"
"	INT015_3_TRAN	DECIMAL(16,8),"
"	FS205_1K_3M	DECIMAL(16,8),"
"	FS205_1K_3M_Q	DECIMAL(16,8),"
"	FS205_1K_3M_Q_TRAN	DECIMAL(16,8),"
"	FS212_1K_3M	DECIMAL(16,8),"
"	FS212_1K_6M	DECIMAL(16,8),"
"	FT212_1K_43	DECIMAL(16,8),"
"	FT212_1K_43_Q	DECIMAL(16,8),"
"	FT212_1K_43_Q_TRAN	DECIMAL(16,8),"
"	MS117_6M	DECIMAL(16,8),"
"	FS014_9M	DECIMAL(16,8),"
"	FS101_9M	DECIMAL(16,8),"
"	INT028_9	DECIMAL(16,8),"
"	INT028_9_TRAN	DECIMAL(16,8),"
"	SEX		INT,"
"	SEX_TRAN	INT,"
"	APP_LAST_MONTH_BUCKET INT,"
"	APP_LAST_MONTH_BUCKET_TRAN INT,"
"	PDACO_SCORE	DECIMAL(16,8),"
"	PDACO_TWEN	DECIMAL(16,8),"
"	PB_IN		DECIMAL(16,8),"
"	PB_INOUT	DECIMAL(16,8),"
"	MS093		DECIMAL(16,8),"
"	MS094		DECIMAL(16,8),"
"	MS105		DECIMAL(16,8),"
"	MS101		DECIMAL(16,8));"
"   INSERT INTO DAC_AUDIT("
" CASE_NO, IDN, INQUIRY_DATE, NOW, AVAIL_FLAG, JAS002_DEFECT, KRM021_HIT, KRM023_HIT, "
" BAM086_HIT, MAX_BUCKET, FS044, FS059_1K_12M, FS302, FS334, CARD_FORCE_STOP,"
" CASH_MAX_BUCKET, CASH_UTILIZATION, IND001, CARD_REV_BAL, CASH_REV_BAL, REVOLVING_AMT,"
" FS102_3M, FS102_6M, FS102_9M, FT102_42, FT102_42_R, FT102_42_R_TRAN, FS031, FS031_TRAN,"
" FS005_1K_3M, FS005_1K_3M_Q, FS005_1K_3M_Q_TRAN, FS059_1K_3M, FS059_1K_6M, FS059_1K_9M,"
" FT059_1K_43, FT059_1K_43_R, FT059_1K_43_R_TRAN, FT059_1K_42, FT059_1K_42_Q,"
" FT059_1K_42_Q_TRAN, FS051, FS051_TRAN, FS016_3M, FS101_3M, INT015_3, INT015_3_TRAN,"
" FS205_1K_3M, FS205_1K_3M_Q, FS205_1K_3M_Q_TRAN, FS212_1K_3M, FS212_1K_6M, FT212_1K_43,"
" FT212_1K_43_Q, FT212_1K_43_Q_TRAN, MS117_6M, FS014_9M, FS101_9M, INT028_9, INT028_9_TRAN,"
" SEX, SEX_TRAN, APP_LAST_MONTH_BUCKET, APP_LAST_MONTH_BUCKET_TRAN, PDACO_SCORE,"
" PDACO_TWEN, PB_IN, PB_INOUT, MS093, MS094, MS105, MS101)"
"   SELECT "
" CASE_NO, IDN, INQUIRY_DATE, NOW, AVAIL_FLAG, JAS002_DEFECT, KRM021_HIT, KRM023_HIT, "
" BAM086_HIT, MAX_BUCKET, FS044, FS059_1K_12M, FS302, FS334, CARD_FORCE_STOP,"
" CASH_MAX_BUCKET, CASH_UTILIZATION, IND001, CARD_REV_BAL, CASH_REV_BAL, REVOLVING_AMT,"
" FS102_3M, FS102_6M, FS102_9M, FT102_42, FT102_42_R, FT102_42_R_TRAN, FS031, FS031_TRAN,"
" FS005_1K_3M, FS005_1K_3M_Q, FS005_1K_3M_Q_TRAN, FS059_1K_3M, FS059_1K_6M, FS059_1K_9M,"
" FT059_1K_43, FT059_1K_43_R, FT059_1K_43_R_TRAN, FT059_1K_42, FT059_1K_42_Q,"
" FT059_1K_42_Q_TRAN, FS051, FS051_TRAN, FS016_3M, FS101_3M, INT015_3, INT015_3_TRAN,"
" FS205_1K_3M, FS205_1K_3M_Q, FS205_1K_3M_Q_TRAN, FS212_1K_3M, FS212_1K_6M, FT212_1K_43,"
" FT212_1K_43_Q, FT212_1K_43_Q_TRAN, MS117_6M, FS014_9M, FS101_9M, INT028_9, INT028_9_TRAN,"
" SEX, SEX_TRAN, APP_LAST_MONTH_BUCKET, APP_LAST_MONTH_BUCKET_TRAN, PDACO_SCORE,"
" PDACO_TWEN, PB_IN, PB_INOUT, MS093, MS094, MS105, MS101"
"   from #PDACO_V1_00_CAL"

};

