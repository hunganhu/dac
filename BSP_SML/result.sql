USE BSP_SML_TEST_200502
GO

SELECT COUNT(*) FROM APP_INFO
SELECT COUNT(*) FROM RESULT
SELECT COUNT(*) FROM RESULT_R

--DELETE FROM APP_INFO
--DELETE FROM RESULT
--DELETE FROM RESULT_R


SELECT * FROM RESULT

--DELETE FROM APPLICANTS

DELETE FROM APPLICANTS
WHERE MSN NOT IN
(SELECT MSN FROM RESULT WHERE RISK_SCORE >= 100)

SELECT NAV, GAV FROM APPLICANTS
WHERE MSN IN
(SELECT MSN COLLATE CHINESE_TAIWAN_STROKE_CI_AS FROM RESULT_V2_NP_TEST WHERE NAV <= 0)

SELECT * FROM RESULT
WHERE RISK_SCORE > 100 AND
      HIGHEST_1 > 0

SELECT A.MSN, 
       A.PRINCIPAL/1000.0, 
       A.TEST_CELL, 
       A.GAV/1000.0, 
       A.NAV/1000.0, 
       (CASE
          WHEN A.ZIP > 253 THEN 0
          WHEN A.ZIP BETWEEN 200 AND 206 THEN 0
          ELSE 1
        END) AS ZIP , 
       A.FIRST_LIEN_VALUE / 1.2 / 1000.0, 
       B.RISK_SCORE, 
       B.DECLINE_REASON,
       B.UNSECURED_BALANCE, 
       B.HIGHEST_1/1000.0, B.HIGHEST_2/1000.0, 
       B.SECURED_PB, B.UNSECURED_PB, 
       B.SECURED_NPV/1000.0, B.UNSECURED_NPV/1000.0,
       B.SC
FROM RESULT AS B INNER JOIN APPLICANTS_TMP AS A
ON A.MSN = B.MSN
WHERE RISK_SCORE < 100 OR HIGHEST_1 > 0
